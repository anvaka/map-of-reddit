{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/lib/bus.js","webpack:///./src/lib/utils.js","webpack:///./src/lib/createSVGLoader.js","webpack:///./src/lib/PointCollection.js","webpack:///./src/lib/PolyLineCollection.js","webpack:///./src/lib/MSDFTextCollection.js","webpack:///./src/lib/ColoredTextCollection.js","webpack:///./src/lib/createFuzzySearcher.js","webpack:///./src/appState.js","webpack:///./src/lib/constants.js","webpack:///./src/lib/LineCollection.js","webpack:///./src/lib/createPointerEventsHandler.js","webpack:///./src/lib/getComplimentaryColor.js","webpack:///./src/lib/createSubgraphVisualizer.js","webpack:///./src/lib/createSceneLayerManager.js","webpack:///./src/lib/BoxCollection.js","webpack:///./src/lib/createStreetView.js","webpack:///./src/lib/createStreamingSVGRenderer.js","webpack:///./src/Tooltip.vue","webpack:///./src/lib/clickOutside.js","webpack:///src/Tooltip.vue","webpack:///./src/Tooltip.vue?ed30","webpack:///./src/Tooltip.vue?c934","webpack:///./src/components/Typeahead.vue","webpack:///src/components/Typeahead.vue","webpack:///./src/components/Typeahead.vue?f4d9","webpack:///./src/components/Typeahead.vue?312c","webpack:///./src/components/Sidebar.vue","webpack:///src/components/Sidebar.vue","webpack:///./src/components/Sidebar.vue?6b69","webpack:///./src/components/Sidebar.vue?1ff0","webpack:///./src/components/ImproveWindow.vue","webpack:///src/components/ImproveWindow.vue","webpack:///./src/components/ImproveWindow.vue?0acb","webpack:///./src/components/ImproveWindow.vue?6b6e","webpack:///./src/SmallPreview.vue","webpack:///./src/LoadingIcon.vue","webpack:///./src/LoadingIcon.vue?dd82","webpack:///src/SmallPreview.vue","webpack:///./src/SmallPreview.vue?188b","webpack:///./src/SmallPreview.vue?49b7","webpack:///./src/lib/createFirstInteractionListener.js","webpack:///src/App.vue","webpack:///./src/App.vue?ccfd","webpack:///./src/App.vue?315a","webpack:///./src/main.js","webpack:///./src/SmallPreview.vue?6f50","webpack:///./src/components/Typeahead.vue?41aa","webpack:///./src/App.vue?c9c2"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","jsonpScriptSrc","p","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_c","_self","attrs","isWebGLEnabled","_e","_m","progressMessage","staticClass","_v","_s","subgraphName","isStreetViewMode","on","$event","preventDefault","onSubgraphRootClick","arguments","onExitSubgraph","isStreetViewInProgress","onExitStreetView","subreddit","defaultSort","defaultTime","onDeclineAge","slot","graphLoaded","showRelated","streetViewEnabled","isSubgraphLayoutInProgress","showStreetView","directives","rawName","multiView","expression","domProps","Array","isArray","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","onSubmit","appState","query","sidebarVisible","findSubreddit","closeSubredditOnSmallScreen","closeSubredditViewer","onTypeAheadInput","class","subgraph","street","onImproveClick","smallPreview","improveVisible","tooltip","style","left","x","top","y","onBackdropClick","staticRenderFns","bus","eventify","setProgress","msg","fire","debounce","cb","ms","self","handle","lastCall","Date","time","elapsed","args","formatNumber","toString","replace","createSVGLoader","url","disposed","graph","createGraph","parseSVGAsync","createStreamingSVGParser","notifyTagOpen","notifyTagClose","api","load","dispose","getGraph","start","performance","now","getLinksCount","getLinkCount","getPathTo","indexOf","baseUrl","URL","pathname","substr","lastIndexOf","fetch","then","response","fetchReader","body","getReader","decoder","TextDecoder","read","processData","progress","decode","stream","done","log","text","txt","labels","split","forEach","label","addNode","fromId","prevBuffer","weight","mapLoaded","tmp","Uint8Array","byteLength","set","lastAvailableByte","Math","floor","view","DataView","buffer","linkId","getInt32","toId","addLink","element","PointCollection","_GLCollection","_inherits","_super","_createSuper","gl","_this","_classCallCheck","program","defineProgram","vertex","fragment","attributes","color","ColorAttribute","instanced","point","InstancedAttribute","preDrawHook","postDrawHook","opacity","hidden","_createClass","drawContext","uniforms","modelViewProjection","cameraDistance","position","draw","setCount","GLCollection","PolyLineCollection","options","debug","_ref","polygon","flat","triangles","earcut","index","add","MSDFTextCollection","getExtension","getTextProgram","img","msdfImage","Image","crossOrigin","isReady","queue","fontSize","fontInfo","fontPath","json","alphabet","Map","chars","char","charValue","String","fromCharCode","id","_sdfTextureChanged","setTextureCanvas","sdfTextureWidth","width","sdfTextureHeight","height","q","addText","bias","textInfo","_textInfo$x","_textInfo$y","_textInfo$z","z","dx","limit","_step","w","_iterator","_createForOfIteratorHelper","sdfPos","xadvance","f","info","size","scale","cx","_step2","_iterator2","cy","_step3","_iterator3","yoffset","charSize","texturePosition","scene","renderFrame","capacity","ColoredTextCollection","fuzzysort","require","createFuzzySearcher","lastPromise","words","addWord","find","word","cancel","goAsync","results","map","html","highlight","pendingSave","qs","state","instance","useSearch","versionToLink","1","2","3","lastVersion","latestGraphLink","versionMissing","graphDefined","userTypedSomething","getFilePath","version","saveQuery","newQuery","newState","unset","getQueryState","getCameraPosition","coordinates","v","Number","parseFloat","isFinite","filter","saveScenePosition","dc","getDrawContext","_dc$view$position","_slicedToArray","Colors","PRIMARY_HIGHLIGHT_COLOR","SECONDARY_HIGHLIGHT_COLOR","TERNARY_COLOR","TERNARY_LINK","LayerLevels","Polygons","Edges","HighlightedEdges","Nodes","Labels","Text","NamedGroups","MainGraph","LineCollection","createPointerEventsHandler","sceneLayerManager","spatialIndex","RBush","moved","isPaused","maxCameraDistance","getScene","handleClick","handleMove","handleTransform","highlightedNodes","getGL","primaryWidth","getPrimaryLineWidth","firstLevelArrows","secondLevelArrows","addToLayer","elementsGroupName","addToNamedGroup","clearHighlights","focusUI","setPaused","getIndex","setViewBox","newBox","max","cameraZPosition","onTransform","k","pixelWidth","getSceneWidthForPixelWidth","getSceneCoordinate","bottom","abs","clear","ui","getHighlightedLinks","linkUI","links","isFirstLevel","getHighlightedNodes","nodeUI","insert","minX","minY","maxX","maxY","removeChild","off","findNearest","newIsPaused","originalEvent","clientX","clientY","neighborIds","knn","neighbor","_ui$position","uiX","uiY","dist","hypot","getComplimentaryColor","lightningFactor","alpha","g","b","_rgbToHsl","rgbToHsl","_rgbToHsl2","h","_hslToRgb","hslToRgb","min","_hslToRgb2","r0","g0","b0","hue2rgb","round","createLayout","FLOOR_COLOR","EDGE_COLOR","Easing","easeInQuart","createSubgraphVisualizer","viewBox","nodeNameToUI","layout","raf","MAX_FRAMES","renderCount","moveThreshold","prevSize","ourNodeNameToUI","points","TextCollection","boundariesFill","transitionAnimator","createTransitionAnimator","pointerEvents","focusSubgraphNode","getPointerEvents","getNameToUI","run","hlNode","_objectSpread","nodeUIs","forEachLinkedNode","other","linkUIs","forEachLink","link","from","to","onSceneIsBack","cancelAnimationFrame","parent","startSceneRestoration","startFadeOut","beginLayout","minSize","Infinity","maxSize","forEachNode","node","timeStep","springLength","springCoefficient","gravity","nodeMass","nodeId","rememberAndSetOriginalPositions","requestAnimationFrame","frame","step","bboxSize","updateNodePositions","movedLength","finishRendering","getBoundingRect","getRootNodeId","root","isRoot","_layout$getNodePositi","getNodePosition","rootNode","subgraphDone","concaveman","default","addPolygon","boundingRect","right","_layout$getNodePositi2","pos","update","copyPosition","ourUI","setNodePosition","durationInFrames","zoomOutViewBox","currentStep","zoomStart","zoomEnd","changeRectangleFinishedCallback","doneCallback","positions","startZoomOut","startZoomIn","getCurrentBoundingRectangle","changeRectangle","side","tan","fov","pixelRatio","getNamedGroup","elements","el","hideNamedGroup","current","nodeCollections","immediate","restoreNamedGroup","fadeIn","lerp","createSceneLayerManager","namedGroups","groupName","group","isHidden","layer","layerIndex","rootElement","getRoot","lastElementWithLowerLayerIndex","children","warn","insertChildAfter","tex","BoxCollection","uiIDToUI","camera","box","setFaceColor","front","back","face","_this2","uiId","frontUI","leftUI","rightUI","backUI","topUI","getFace","rotateFace","PI","translateFace","addFace","removeFace","angle","axis","cos","sin","x0","y0","z0","_point","quadPoints","_this3","texCoordinate","quadUI","_this4","oldId","newId","remove","movedUI","delete","createStreetView","nameToUI","fpsUI","boxes","items","asyncRender","enter","exit","lookAt","visibleBoxes","Set","visibilityUpdate","uiToBox","visibleElements","lastVisibilityUpdate","domContainer","DomContainer","seeThrough","_node$position","a","cameraController","getCameraController","setCameraController","fpsControls","minDimension","moveSpeed","setMoveSpeed","setScrollSpeed","setFlySpeed","enableMouseCapture","createFPSControlsUI","renderFirstBatch","scheduleVisibilityUpdate","_node$position2","neighbors","item","addBox","renderTheRest","processNext","localCount","has","_ui$position2","streetViewDone","hideElement","mapControls","showElement","dom","dy","sqrt","DomElement","ox","oy","oz","vec3","cross","normalize","quat","rotationTo","rotateZ","mat4","fromRotationTranslationScale","model","worldTransformNeedsUpdate","updated","updateVisibility","eye","center","lookDirection","getDirection","getMostVisibleNeighbors","sort","nowVisible","intersections","minT","minFace","checkFaceIntersection","count","castRay","_from","r_px","r_py","_a","s_px","s_py","s_dx","s_dy","_getDirection","_getDirection2","r_dx","r_dy","t2","ta","isNaN","dir","maxCount","maxAngle","checkAngle","candidate","candidateDirection","dot","acos","out","len","createStreamingSVGRenderer","canvas","preStreetViewCameraPosition","inputTarget","streetView","ignoreSVGViewBox","isStreetView","initScene","fuzzySearcher","loader","subgraphVisualizer","persistedName","nodes","labelsText","currentTransform","createTransformParser","nodesByComponent","complimentaryColor","clusterColors","setProgressDebounced","focusNode","unfocus","exitSubgraphMode","loadSVG","focus","exitStreetView","getNeighbors","componentId","idx","maxLinks","secondaryLinkColor","neighborId","trim","currentPointerEvents","hide","show","lookAtNode","otherNode","subgraphNodes","addNeighbors","neighborsSet","runSubGraphVisualizer","addedNode","getNode","isFirstChild","hasLink","isRootLevel","nodeName","path","handleElementStart","handleElementEnd","tagName","viewBoxArr","finiteNumber","addBorder","transform","pushTransform","popTransform","innerText","appendTextLabel","getNumericAttribute","hexColor","getElementFillColor","transformY","getTextAttribute","getLoadedSubreddits","_parseBorder","parseBorder","clusterId","querySelector","createScene","allowPinchRotation","near","minZoom","useDeviceOrientation","setClearColor","cameraPosition","initialSceneSize","getPointsFromPathData","_ref2","_currentTransform$tra","_currentTransform$tra2","isDirty","tx","ty","transformStack","transformStr","parseTransform","pop","str","transformNumbers","match","coefficients","updateTransform","record","defaultValue","rgbArray","startClick","props","methods","component","hideSuggestions","menuClicked","ref","placeholder","currentQuery","handleInput","cycleTheList","showClearButton","clearSearch","showSuggestions","_l","suggestions","suggestion","selected","pickSuggestion","showLoading","loadingError","nodeList","ctx","seed","createDocumentHandler","binding","vnode","mouseup","mousedown","context","contains","popperElm","methodName","bindingFn","addEventListener","documentHandler","unbind","ClickOutside","delay","currentSelected","watch","refresh","getSuggestionsInternal","$emit","pendingKeyToShow","showIfNeeded","visible","$refs","input","composedQuery","parts","part","join","payload","shouldProceed","previous","which","onClose","mounted","handleKeyDown","beforeDestroy","removeEventListener","showFullPreview","details","subscribers","active","loading","image","icon","description","components","LoadingIcon","getSubredditInfo","fetchedName","public_description","displayName","display_name_prefixed","accounts_active","icon_img","community_icon","banner","banner_img","banner_background_image","over18","ageConfirmed","createFirstInteractionListener","callback","handleFirstEvent","called","Instance","Vue","extend","Subreddit","nameToInstance","Tooltip","Typeahead","Sidebar","ImproveWindow","SmallPreview","newValue","getFirstSubreddit","unshift","showSubreddit","isSmallScreen","typeaheadChanged","showTooltip","originalQuery","forceFullView","disposeFirstListener","subgraphVisualized","appendDom","oldInstance","$destroy","div","viewer","propsData","showFirst","$on","newSort","newTime","$mount","removeDom","getElementById","svgRenderer","innerWidth","potentiallyMultiViewName","config","productionTip","App","_document$querySelect"],"mappings":"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","file":"js/app.d2ae4d22.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-9475eac2\":\"1e9ebc1b\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"app\"}},[(!_vm.isWebGLEnabled)?_c('div',[_vm._m(0)]):_vm._e(),(_vm.isWebGLEnabled)?_c('div',[_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.progressMessage)?_c('div',{staticClass:\"progress\"},[_vm._v(_vm._s(_vm.progressMessage))]):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.subgraphName && !_vm.isStreetViewMode)?_c('div',{staticClass:\"progress subgraph\"},[_vm._v(\" Only \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubgraphRootClick.apply(null, arguments)}}},[_vm._v(\"/r/\"+_vm._s(_vm.subgraphName))]),_vm._v(\" related subreddits are shown. \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onExitSubgraph.apply(null, arguments)}}},[_vm._v(\"view all\")])]):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.isStreetViewMode && !_vm.isStreetViewInProgress)?_c('div',{staticClass:\"progress subgraph\"},[_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onExitStreetView.apply(null, arguments)}}},[_vm._v(\"exit street view\")])]):_vm._e()]),(_vm.subreddit)?_c('subreddit',{staticClass:\"preview\",attrs:{\"name\":_vm.subreddit,\"sort\":_vm.defaultSort,\"time\":_vm.defaultTime},on:{\"declineAge\":_vm.onDeclineAge}},[_c('template',{slot:\"after-title\"},[_c('div',[(_vm.graphLoaded)?_c('a',{staticClass:\"subreddit-action\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showRelated.apply(null, arguments)}}},[_vm._v(\"Show related\")]):_vm._e(),(_vm.streetViewEnabled && _vm.graphLoaded && !_vm.isSubgraphLayoutInProgress)?_c('a',{staticClass:\"subreddit-action\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showStreetView.apply(null, arguments)}}},[_vm._v(\"Street view\")]):_vm._e(),(_vm.graphLoaded)?_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.multiView),expression:\"multiView\"}],attrs:{\"type\":\"checkbox\",\"id\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.multiView)?_vm._i(_vm.multiView,null)>-1:(_vm.multiView)},on:{\"change\":function($event){var $$a=_vm.multiView,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.multiView=$$a.concat([$$v]))}else{$$i>-1&&(_vm.multiView=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.multiView=$$c}}}}),_c('label',{attrs:{\"for\":\"checkbox\"}},[_vm._v(\"Multireddit view from neighbors\")])]):_vm._e(),(!_vm.graphLoaded)?_c('span',{staticClass:\"subreddit-action\"},[_vm._v(\"the map is still loading...\")]):_vm._e()])])],2):_vm._e(),_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit.apply(null, arguments)}}},[_c('typeahead',{attrs:{\"placeholder\":\"Find subreddit\",\"showClearButton\":_vm.subreddit,\"query\":_vm.appState.query},on:{\"menuClicked\":function($event){_vm.sidebarVisible = true},\"selected\":_vm.findSubreddit,\"beforeClear\":_vm.closeSubredditOnSmallScreen,\"cleared\":_vm.closeSubredditViewer,\"inputChanged\":_vm.onTypeAheadInput}})],1),(_vm.graphLoaded && _vm.progressMessage === null)?_c('div',{staticClass:\"support\",class:{subgraph: _vm.subgraphName && !_vm.isStreetViewMode, street: _vm.isStreetViewMode}},[_vm._v(\" Enjoying this map? \"),_c('br'),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.paypal.com/paypalme/anvakos/5\",\"target\":\"_blank\"}},[_vm._v(\"Support the author\")])]):_vm._e(),_c('a',{staticClass:\"accent improve\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onImproveClick.apply(null, arguments)}}},[_vm._v(\"Improve this map\")]),_c('transition',{attrs:{\"name\":\"slide-bottom\"}},[(_vm.smallPreview)?_c('small-preview',{staticClass:\"small-preview\",attrs:{\"name\":_vm.smallPreview}}):_vm._e()],1),_c('transition',{attrs:{\"name\":\"slide-top\"}},[(_vm.improveVisible)?_c('improve-window',{staticClass:\"improve-window\",on:{\"close\":function($event){_vm.improveVisible = false}}}):_vm._e()],1),(_vm.tooltip)?_c('tooltip',{staticClass:\"tooltip\",style:({\n    left: _vm.tooltip.x + 'px',\n    top: _vm.tooltip.y + 'px'\n  }),attrs:{\"data\":_vm.tooltip}}):_vm._e(),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.sidebarVisible || _vm.improveVisible)?_c('div',{staticClass:\"backdrop\",on:{\"click\":_vm.onBackdropClick}}):_vm._e()]),_c('transition',{attrs:{\"name\":\"slide-left\"}},[(_vm.sidebarVisible)?_c('sidebar',{on:{\"close\":function($event){_vm.sidebarVisible = false}}}):_vm._e()],1)],1):_vm._e()])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h4',[_vm._v(\"WebGL is not enabled :(\")]),_c('p',[_vm._v(\"This website needs \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://en.wikipedia.org/wiki/WebGL\"}},[_vm._v(\"WebGL\")]),_vm._v(\" to render a map of reddit. \")]),_vm._v(\" \"),_c('p',[_vm._v(\" You can try another browser. If the problem persists - very likely your video card isn't supported. \")])])\n}]\n\nexport { render, staticRenderFns }","import eventify from 'ngraph.events';\n\nconst bus = eventify({});\n\nexport default bus;\n\nexport function setProgress(msg) {\n    bus.fire('progress', msg());\n}","\nexport function debounce(cb, ms, self) {\n  let lastCall = new Date();\n  let handle;\n\n  return function() {\n    let time = new Date();\n    let elapsed = time - lastCall;\n    clearTimeout(handle);\n    if (elapsed > ms) {\n      cb.apply(self, arguments)\n    } else {\n      lastCall = time;\n      const args = arguments;\n      handle = setTimeout(function() {\n        cb.apply(self, args);\n      }, ms)\n    }\n  }\n}\n\nexport function formatNumber(x) {\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}","import eventify from 'ngraph.events';\nimport createGraph from 'ngraph.graph';\nimport {createStreamingSVGParser} from 'streaming-svg-parser';\nimport {setProgress} from './bus';\nimport {formatNumber} from './utils';\n\nexport default function createSVGLoader(url) {\n  let disposed = false;\n  let graph = createGraph();\n  let parseSVGAsync = createStreamingSVGParser(notifyTagOpen, notifyTagClose, true)\n\n  let api = eventify({load, dispose, getGraph() { return graph; }});\n  return api;\n\n  function dispose() {\n    disposed = true;\n  }\n\n  function load() {\n    let start = window.performance.now();\n    fetch(url, {mode: 'cors'}).then(response => {\n      let fetchReader = response.body.getReader();\n      let decoder = new TextDecoder();\n\n      return fetchReader.read().then(processData);\n\n      function processData(progress) {\n        if (disposed) return;\n\n        let chunk = (progress.value !== undefined && decoder.decode(progress.value, {stream: !progress.done})) || '';\n        return parseSVGAsync(chunk).then(() => {\n          if(progress.done) {\n            return;\n          }\n          return fetchReader.read().then(processData);\n        });\n      }\n    }).then(() => {\n      console.log('Elapsed: ', window.performance.now() - start);\n      setProgress(() => ({\n        message: 'Loading links...'\n      }));\n      // now the svg file is loaded. Let's load secondary information\n      return fetch(getPathTo('node-ids.txt'), {mode: 'cors'}).then(response => response.text()).then(txt => {\n        let labels = txt.split('\\n');\n        labels.forEach(label => graph.addNode(label));\n        return labels;\n      });\n    }).then((labels) => {\n      // now load the edges:\n      let fromId, fetchReader, prevBuffer, weight;\n      return fetch(getPathTo('links.bin'), {mode: 'cors'})\n      .then(response => {\n        fetchReader = response.body.getReader();\n        return fetchReader.read().then(processData);\n      });\n\n      function processData(progress) {\n        if (disposed) return;\n\n        let chunk = progress.value;\n        if (!chunk && prevBuffer) {\n          throw new Error('Incomplete response');\n        }\n        if (!chunk) {\n          setProgress(() => ({\n            mapLoaded: true,\n          }));\n          return graph;\n        }\n\n        if (prevBuffer) {\n          let tmp = new Uint8Array(prevBuffer.byteLength + chunk.byteLength);\n          tmp.set(new Uint8Array(prevBuffer), 0);\n          tmp.set(new Uint8Array(chunk), prevBuffer.byteLength);\n          chunk = tmp;\n          prevBuffer = null;\n        }\n        let lastAvailableByte = Math.floor(chunk.byteLength / 4) * 4;\n        if (chunk.byteLength % 4 !== 0) {\n          prevBuffer = chunk.slice(lastAvailableByte);\n        }\n        const view = new DataView(chunk.buffer);\n        for (let i = 0; i < lastAvailableByte; i += 4) {\n          let linkId = view.getInt32(i, /* little endian = */ true);\n          if (linkId < 0) {\n            fromId = -linkId - 1;\n            weight = 1;\n            graph.addNode(labels[fromId]);\n          } else {\n            let toId = linkId - 1;\n            graph.addLink(labels[fromId], labels[toId], weight)\n            weight += 1;\n          }\n        }\n\n        if (progress.done) {\n          setProgress(() => ({\n            mapLoaded: true\n          }));\n          return graph;\n        }\n        setProgress(getLinksCount);\n        return fetchReader.read().then(processData);\n      }\n    });\n\n    function getLinksCount() {\n      return {\n        message: 'Loaded ' + formatNumber(graph.getLinkCount()) + ' relationship records'\n      }\n    }\n\n    function getPathTo(name) {\n      if (url.indexOf('http') < 0) return name;\n      let baseUrl = new URL(url);\n      baseUrl.pathname = baseUrl.pathname.substr(0, baseUrl.pathname.lastIndexOf('/') + 1) + name;\n      return baseUrl.toString();\n    }\n\n    return api;\n  }\n\n  function notifyTagOpen(element) {\n    api.fire('element-start', element);\n  }\n\n  function notifyTagClose(element) {\n    api.fire('element-end', element)\n  }\n\n}","\nimport {GLCollection, defineProgram, ColorAttribute, InstancedAttribute} from 'w-gl';\n\nexport default class PointCollection extends GLCollection {\n  constructor(gl) {\n    let program = defineProgram({\n      gl,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float opacity;\n  uniform float cameraDistance;\n\n  attribute float size;\n  attribute vec3 position;\n  attribute vec4 color;\n\n  attribute vec2 point; // instanced\n\n  varying vec4 vColor;\n  varying vec2 vPoint;\n  void main() {\n    gl_Position = modelViewProjection * vec4(position + vec3(point * size, 0.), 1.0);\n    vColor = color.abgr;\n    vColor[3] *= opacity *  (1. - smoothstep(0.0, 1., cameraDistance / (3000. * size)));\n    vPoint = point;\n  }`,\n\n      fragment: `\n  precision highp float;\n  varying vec4 vColor;\n  varying vec2 vPoint;\n  void main() {\n    float dist = length(vPoint);\n    if (dist >= 0.5) {discard;}\n    gl_FragColor = vColor;\n  }`,\n      // These are just overrides:\n      attributes: {\n        color: new ColorAttribute(),\n      },\n      instanced: {\n        point: new InstancedAttribute([\n          -0.5, -0.5, -0.5,  0.5, 0.5,  0.5,\n          0.5,  0.5, 0.5, -0.5, -0.5, -0.5,\n        ])\n      },\n\n      preDrawHook(/* programInfo */) {\n        return `gl.enable(gl.DEPTH_TEST);\n        gl.depthFunc(gl.LEQUAL);`;\n      },\n      postDrawHook() {\n        return 'gl.disable(gl.DEPTH_TEST);';\n      },\n    });\n\n    super(program);\n    this.opacity = 1;\n    this.hidden = false;\n  }\n  hide() {\n    this.hidden = true;\n  }\n  show() {\n    this.hidden = false;\n  }\n  draw(gl, drawContext) {\n    if (this.hidden) return;\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n    this.program.draw(this.uniforms);\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n}","import earcut from 'earcut';\nimport {defineProgram, ColorAttribute, GLCollection} from 'w-gl';\n\nexport default class PolyLineCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    let program = defineProgram({\n      gl,\n      debug: options.debug,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float opacity;\n\n  attribute vec2 point;\n  attribute vec4 color;\n  varying vec4 vColor;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(point, -1.0, 1.0);\n    vColor = color.abgr;\n    vColor[3] *= opacity;\n  }`,\n\n      fragment: `\n  precision highp float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }`,\n      attributes: {\n        color: new ColorAttribute(),\n      },\n    });\n    super(program);\n    this.opacity = options.opacity === undefined ? 1 : options.opacity;\n    this.color = options.color || 0x000000ff;\n  }\n\n  draw() {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.program.draw(this.uniforms);\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  addPolygon({ polygon, color }) {\n    polygon = polygon.flat();\n    let triangles = earcut(polygon);\n    for (let i = 0; i < triangles.length; i++) {\n      let index = triangles[i] * 2;\n      this.add({\n        point: [polygon[index], polygon[index + 1]],\n        color: color || this.color,\n      });\n    }\n\n    for (let i = 0; i < 3; ++i) {\n      this.add({\n        point: [0, 0],\n        color: 0x0,\n      });\n    }\n  }\n}\n","import { defineProgram, InstancedAttribute, GLCollection } from 'w-gl';\n\nexport default class MSDFTextCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    gl.getExtension('OES_standard_derivatives');\n\n    super(getTextProgram(gl, options));\n\n    let img = (this.msdfImage = new Image());\n    img.crossOrigin = 'Anonymous';\n    this.isReady = false;\n    this.queue = [];\n    this.fontSize = options.fontSize || 2;\n    this.opacity = options.opacity !== undefined ? options.opacity : 1;\n    this.fontInfo = null;\n\n    let fontPath = 'fonts';\n    fetch(`${fontPath}/Roboto.json`, { mode: 'cors' })\n      .then((x) => x.json())\n      .then((fontInfo) => {\n        this.fontInfo = fontInfo;\n        this.alphabet = new Map();\n        fontInfo.chars.forEach((char) => {\n          let charValue = String.fromCharCode(char.id);\n          this.alphabet.set(charValue, char);\n        });\n\n        this.msdfImage.onload = () => {\n          this._sdfTextureChanged = true;\n          this.program.setTextureCanvas('msdf', this.msdfImage);\n          this.isReady = true;\n          this.sdfTextureWidth = img.width;\n          this.sdfTextureHeight = img.height;\n\n          this.queue.forEach((q) => this.addText(q));\n          this.queue = [];\n        };\n        this.msdfImage.src = `${fontPath}/Roboto0.png`;\n      });\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        color: [0.9, 0.9, 0.9, 1.0],\n        bias: 0.5,\n        opacity: this.opacity\n      };\n    }\n\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n    this.uniforms.opacity = this.opacity;\n\n    // This draws text outline. TODO: Can I get rid of this call?\n    this.uniforms.color[0] = 0.2;\n    this.uniforms.color[1] = 0.4;\n    this.uniforms.color[2] = 0.8;\n    this.uniforms.color[3] = 0.8;\n    this.uniforms.bias = 0.35;\n    this.program.draw(this.uniforms);\n\n    // This draws text itself\n    this.uniforms.color[0] = 0.9;\n    this.uniforms.color[1] = 0.9;\n    this.uniforms.color[2] = 0.9;\n    this.uniforms.color[3] = 1;\n    this.uniforms.bias = 0.5;\n    this.program.draw(this.uniforms);\n  }\n\n  addText(textInfo) {\n    if (!this.isReady) {\n      this.queue.push(textInfo);\n      return;\n    }\n    let { text, x = 0, y = 0, z = 0 } = textInfo;\n    if (text === undefined) {\n      throw new Error('Text is not defined in ' + textInfo);\n    }\n    let dx = 0;\n    let fontSize = textInfo.fontSize || this.fontSize;\n    if (textInfo.limit !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n        w += sdfPos.xadvance;\n      }\n      fontSize = (textInfo.limit * this.fontInfo.info.size) / w;\n    }\n\n    let scale = fontSize / this.fontInfo.info.size;\n    if (textInfo.cx !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n\n        w += sdfPos.xadvance;\n      }\n      dx -= w * textInfo.cx * scale;\n    }\n    if (textInfo.cy !== undefined) {\n      y += fontSize * textInfo.cy;\n    }\n\n    for (let char of text) {\n      let sdfPos = this.alphabet.get(char);\n      if (!sdfPos) {\n        console.error(char + ' is missing in the font');\n        continue;\n      }\n\n      this.add({\n        position: [x + dx, y - sdfPos.yoffset * scale, z],\n        charSize: [\n          (fontSize * sdfPos.width) / 42,\n          (-fontSize * sdfPos.height) / 42,\n          fontSize,\n        ],\n        texturePosition: [\n          sdfPos.x / this.sdfTextureWidth,\n          1 - sdfPos.y / this.sdfTextureHeight,\n          sdfPos.width / this.sdfTextureWidth,\n          -sdfPos.height / this.sdfTextureHeight,\n        ],\n      });\n      dx += sdfPos.xadvance * scale;\n    }\n    if (this.scene) this.scene.renderFrame();\n  }\n}\n\nfunction getTextProgram(gl, options) {\n  return defineProgram({\n    capacity: options.capacity || 1,\n    buffer: options.buffer,\n    debug: options.debug,\n    gl,\n    vertex: `\n  uniform mat4 modelViewProjection;\n  uniform vec4 color;\n  uniform float cameraDistance;\n\n  // Position of the text character:\n  attribute vec3 position;\n  // Instanced quad coordinate:\n  attribute vec2 point;\n  attribute vec3 charSize;\n  // [x, y, w, h] - of the character in the msdf texture;\n  attribute vec4 texturePosition;\n\n  varying vec4 vColor;\n  varying vec2 vPoint;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(position + vec3(vec2(point.x, point.y) * charSize.xy, position.z), 1.);\n    vPoint = texturePosition.xy + point * texturePosition.zw;\n    vColor = color;\n    vColor[3] *= (1. - smoothstep(0.0, 1., cameraDistance / (5000. * charSize.z)));\n  }`,\n\n    fragment: `\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n  precision highp float;\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  uniform float bias;\n  uniform float opacity;\n  uniform float cameraDistance;\n  uniform sampler2D msdf;\n\n  float median(float r, float g, float b) {\n    return max(min(r, g), min(max(r, g), b));\n  }\n\n  void main() {\n    vec3 sample = texture2D(msdf, vPoint).rgb;\n    float sigDist = median(sample.r, sample.g, sample.b) - bias;\n    float alpha = clamp(sigDist / fwidth(sigDist) + bias, 0.0, 1.0);\n    gl_FragColor = vec4(vColor.rgb, vColor.a * alpha * opacity);\n  }`,\n    instanced: {\n      point: new InstancedAttribute([\n        0, 0, \n        1, 0, \n        1, 1, \n\n        1, 1, \n        0, 0, \n        0, 1]),\n    },\n  });\n}\n","import { defineProgram, ColorAttribute, InstancedAttribute, GLCollection } from 'w-gl';\n\nexport default class ColoredTextCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    gl.getExtension('OES_standard_derivatives');\n\n    super(getTextProgram(gl, options));\n\n    // TODO: this duplicates MSDFTextCollection. DRY it.\n    let img = (this.msdfImage = new Image());\n    img.crossOrigin = 'Anonymous';\n    this.isReady = false;\n    this.queue = [];\n    this.fontSize = options.fontSize || 2;\n    this.opacity = options.opacity !== undefined ? options.opacity : 1;\n    this.fontInfo = null;\n\n    let fontPath = 'fonts';\n    fetch(`${fontPath}/Roboto.json`, { mode: 'cors' })\n      .then((x) => x.json())\n      .then((fontInfo) => {\n        this.fontInfo = fontInfo;\n        this.alphabet = new Map();\n        fontInfo.chars.forEach((char) => {\n          let charValue = String.fromCharCode(char.id);\n          this.alphabet.set(charValue, char);\n        });\n\n        this.msdfImage.onload = () => {\n          this._sdfTextureChanged = true;\n          this.program.setTextureCanvas('msdf', this.msdfImage);\n          this.isReady = true;\n          this.sdfTextureWidth = img.width;\n          this.sdfTextureHeight = img.height;\n\n          this.queue.forEach((q) => this.addText(q));\n          this.queue = [];\n        };\n        this.msdfImage.src = `${fontPath}/Roboto0.png`;\n      });\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        bias: 0.5,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n\n    this.uniforms.bias = 0.5;\n    this.program.draw(this.uniforms);\n  }\n\n  addText(textInfo) {\n    if (!this.isReady) {\n      this.queue.push(textInfo);\n      return;\n    }\n    let { text, x = 0, y = 0, z = 0 } = textInfo;\n    if (text === undefined) {\n      throw new Error('Text is not defined in ' + textInfo);\n    }\n    let dx = 0;\n    let fontSize = textInfo.fontSize || this.fontSize;\n    if (textInfo.limit !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n        w += sdfPos.xadvance;\n      }\n      fontSize = (textInfo.limit * this.fontInfo.info.size) / w;\n    }\n\n    let scale = fontSize / this.fontInfo.info.size;\n    if (textInfo.cx !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n\n        w += sdfPos.xadvance;\n      }\n      dx -= w * textInfo.cx * scale;\n    }\n    if (textInfo.cy !== undefined) {\n      y += fontSize * textInfo.cy;\n    }\n\n    for (let char of text) {\n      let sdfPos = this.alphabet.get(char);\n      if (!sdfPos) {\n        console.error(char + ' is missing in the font');\n        continue;\n      }\n\n      this.add({\n        position: [x + dx, y - sdfPos.yoffset * scale, z],\n        color: textInfo.color,\n        charSize: [\n          (fontSize * sdfPos.width) / 42,\n          (-fontSize * sdfPos.height) / 42,\n          fontSize\n        ],\n        texturePosition: [\n          sdfPos.x / this.sdfTextureWidth,\n          1 - sdfPos.y / this.sdfTextureHeight,\n          sdfPos.width / this.sdfTextureWidth,\n          -sdfPos.height / this.sdfTextureHeight,\n        ],\n      });\n      dx += sdfPos.xadvance * scale;\n    }\n    if (this.scene) this.scene.renderFrame();\n  }\n}\n\nfunction getTextProgram(gl, options) {\n  return defineProgram({\n    capacity: options.capacity || 1,\n    buffer: options.buffer,\n    debug: options.debug,\n    gl,\n    vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float cameraDistance;\n\n  attribute vec4 color;\n\n  // Position of the text character:\n  attribute vec3 position;\n  // Instanced quad coordinate:\n  attribute vec2 point;\n  attribute vec3 charSize;\n  // [x, y, w, h] - of the character in the msdf texture;\n  attribute vec4 texturePosition;\n\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(\n      position + vec3(vec2(point.x, point.y) * charSize.xy, position.z), 1.);\n    vPoint = texturePosition.xy + point * texturePosition.zw;\n    vColor = color.abgr;\n    vColor[3] = smoothstep(0.2, 0.8, cameraDistance / (50. * charSize.z) );\n  }`,\n\n    fragment: `\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n  precision highp float;\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  uniform float bias;\n  uniform float opacity;\n  uniform sampler2D msdf;\n\n  float median(float r, float g, float b) {\n    return max(min(r, g), min(max(r, g), b));\n  }\n\n  void main() {\n    vec3 sample = texture2D(msdf, vPoint).rgb;\n    float sigDist = median(sample.r, sample.g, sample.b) - bias;\n    float alpha = clamp(sigDist / fwidth(sigDist) + bias, 0.0, 1.0);\n    gl_FragColor = vec4(vColor.rgb, vColor.a * alpha * opacity);\n  }`,\n    attributes: {\n      color: new ColorAttribute(),\n    },\n    instanced: {\n      point: new InstancedAttribute([0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1]),\n    },\n  });\n}\n","const fuzzysort = require('fuzzysort')\n\nexport default function createFuzzySearcher() {\n  let words = [];\n  let lastPromise;\n  let api = {\n    addWord,\n    find\n  }\n\n  return api;\n\n  function addWord(word) {\n    words.push(word);\n  }\n\n  function find(query) {\n    if (lastPromise) {\n      lastPromise.cancel();\n    }\n    lastPromise = fuzzysort.goAsync(query, words, {limit: 10})\n\n    return lastPromise.then(results => {\n      return results.map(x => ({\n        html: fuzzysort.highlight(x, '<b>', '</b>'),\n        text: x.target\n      }));\n    }); \n    // if(invalidated) promise.cancel()\n  }\n}","let qs = require('query-state')\nlet state = qs.instance({}, {useSearch: true})\nlet pendingSave;\nlet versionToLink = {\n  1: 'https://anvaka.github.io/map-of-reddit-data/graph.svg',\n  2: 'https://anvaka.github.io/map-of-reddit-data/v2/graph.svg',\n  3: 'https://anvaka.github.io/map-of-reddit-data/v3/graph.svg',\n  // 4: 'http://127.0.0.1:8080/graph.svg',\n};\n\nlet lastVersion = 3;\nlet latestGraphLink = versionToLink[lastVersion];\n// we should ignore camera position if user doesn't have graph version in the link\n// it means they have stored previous link, and we have changed the graph, so their\n// link wouldn't work correctly.\nlet versionMissing = state.get('v') === undefined;\nlet graphDefined = state.get('graph') !== undefined;\n\nexport default {\n  query: state.get('q') || '',\n  userTypedSomething: false,\n\n  getFilePath() {\n    const version = state.get('v')\n    return state.get('graph') || versionToLink[version] || latestGraphLink;\n  },\n  saveQuery(newQuery) {\n    // make sure we store the version in all new calls:\n    if (newQuery) {\n      const newState = {q: newQuery};\n      state.set(newState);\n    } else {\n      state.unset('q');\n    }\n  },\n  getQueryState() {\n    return state;\n  },\n  getCameraPosition() {\n    if (versionMissing && !graphDefined) return;\n    let coordinates = ['x', 'y', 'z'].map(name => {\n      let v = Number.parseFloat(state.get(name));\n      if (Number.isFinite(v)) return v;\n    }).filter(x => x !== undefined);\n    if (coordinates.length === 3) return coordinates;\n  },\n  saveScenePosition(scene) {\n    if (pendingSave) {\n      clearTimeout(pendingSave);\n      pendingSave = 0;\n    }\n\n    pendingSave = setTimeout(() => {\n      pendingSave = 0;\n      let dc = scene.getDrawContext();\n      let [x, y, z] = dc.view.position;\n      let position = {x, y, z}\n\n      if (versionMissing && !graphDefined) {\n        position.v = lastVersion;\n      }\n      state.set(position);\n    }, 300);\n  }\n}","export const Colors = {\n  PRIMARY_HIGHLIGHT_COLOR: 0xBF2172ff,\n  SECONDARY_HIGHLIGHT_COLOR: 0xE56BAAff,\n  TERNARY_COLOR: 0xdcdcdcff,\n  TERNARY_LINK: 0x88888844\n};\n\nexport const LayerLevels = {\n  Polygons: 0,\n  Edges: 5,\n  HighlightedEdges: 7,\n  Nodes: 10,\n  Labels: 12,\n  Text: 15\n}\n\nexport const NamedGroups = {\n  MainGraph: 'main-graph-view'\n}","import {GLCollection, defineProgram, InstancedAttribute, ColorAttribute} from 'w-gl';\n\n// Note: the shader has a bug with z coordinate of the arrow. I'm still keeping it and maybe will get back\n// to it later\nexport default class LineCollection extends GLCollection {\n    constructor(gl, options) {\n      let program = defineProgram({\n        gl,\n        vertex: `\nuniform mat4 modelViewProjection;\nuniform float width;\n\nattribute vec3 from, to;\nattribute vec2 point;\nattribute vec4 color;\nvarying vec2 vPoint;\nvarying vec4 vColor;\n\nvoid main() {\n  vec2 xBasis = normalize(to - from).xy;\n  vec2 yBasis = vec2(-xBasis.y, xBasis.x);\n  vec4 clip0 = modelViewProjection * vec4(from.xy + width * yBasis * point.x, from.z, 1.0);\n  vec4 clip1 = modelViewProjection * vec4(to.xy + width * yBasis * point.x, to.z, 1.0);\n  gl_Position = mix(clip0, clip1, point.y);\n  vColor = color;\n}`,\n\n        fragment: `\n    precision highp float;\n    varying vec4 vColor;\n\n    void main() {\n      gl_FragColor = vColor.abgr;\n    }`,\n      attributes: {\n        color: new ColorAttribute(),\n      },\n      instanced: {\n          point: new InstancedAttribute([\n            -0.5, 0, -0.5, 1, 0.5, 1, // First 2D triangle of the quad\n            -0.5, 0, 0.5, 1, 0.5, 0   // Second 2D triangle of the quad\n          ])\n        }\n      });\n      super(program);\n      this.width = (options && options.width) || 1;\n    }\n\n    draw() {\n      if (!this.uniforms) {\n        this.uniforms = {\n          modelViewProjection: this.modelViewProjection,\n          width: this.width,\n        }\n      }\n      this.uniforms.width = this.width;\n      this.program.draw(this.uniforms);\n    }\n    // add(line) {\n    //   if (line.width === undefined) line.width = this.width;\n    //   super.add(line);\n    // }\n\n    clear() {\n      this.program.setCount(0);\n    }\n  }","/**\n * This class is responsible for finding nodes under cursor\n */\nimport RBush from 'rbush';\nimport knn from 'rbush-knn';\nimport bus from './bus';\nimport LineCollection from './LineCollection';\nimport PointCollection from './PointCollection';\nimport {LayerLevels} from './constants';\n\nexport default function createPointerEventsHandler(sceneLayerManager, options) {\n  const spatialIndex = new RBush();\n  let moved = false;\n  let isPaused = false;\n  let maxCameraDistance = 8000;\n  const scene = sceneLayerManager.getScene();\n\n  scene.on('click', handleClick);\n  scene.on('mousemove', handleMove);\n  scene.on('transform', handleTransform);\n\n  const highlightedNodes = new PointCollection(scene.getGL());\n  let primaryWidth = getPrimaryLineWidth(scene.getDrawContext().view.position[2]);\n  const firstLevelArrows = new LineCollection(scene.getGL(), {width: primaryWidth});\n  const secondLevelArrows = new LineCollection(scene.getGL(), {width: primaryWidth/2});\n\n  sceneLayerManager.addToLayer(secondLevelArrows, LayerLevels.Edges);\n  sceneLayerManager.addToLayer(firstLevelArrows, LayerLevels.HighlightedEdges);\n  sceneLayerManager.addToLayer(highlightedNodes, LayerLevels.Nodes);\n\n  if (options.elementsGroupName) {\n    sceneLayerManager.addToNamedGroup(firstLevelArrows, options.elementsGroupName);\n    sceneLayerManager.addToNamedGroup(secondLevelArrows, options.elementsGroupName);\n    sceneLayerManager.addToNamedGroup(highlightedNodes, options.elementsGroupName);\n  }\n\n  return {\n    addNode,\n    clearHighlights,\n    focusUI,\n    dispose,\n    setPaused,\n    getIndex() {\n      return spatialIndex;\n    },\n    setViewBox\n  }\n\n  function setViewBox(newBox) {\n    maxCameraDistance = Math.max(newBox.width, newBox.height);\n  }\n\n  function handleTransform(e) {\n    if (isPaused) return;\n    let cameraZPosition = e.drawContext.view.position[2];\n    firstLevelArrows.width = getPrimaryLineWidth(cameraZPosition);\n    secondLevelArrows.width = firstLevelArrows.width / 2;\n    moved = true;\n    if (options && options.onTransform) options.onTransform();\n  }\n\n  function getPrimaryLineWidth(cameraZPosition) {\n    const k = cameraZPosition / maxCameraDistance;\n    let pixelWidth = 6 - 2 * k;\n    if (k < 0) pixelWidth = 5;\n    if (k > 2) pixelWidth = Math.log(k) / Math.log(2) + 1;\n    return getSceneWidthForPixelWidth(pixelWidth/8)\n  }\n\n  function getSceneWidthForPixelWidth(pixelWidth) {\n    let dc = scene.getDrawContext();\n    let top = scene.getSceneCoordinate(dc.width / 2, dc.height / 2 - pixelWidth / 2);\n    let bottom = scene.getSceneCoordinate(dc.width / 2, dc.height / 2 + pixelWidth / 2);\n    return Math.abs(top[1] - bottom[1]);\n  }\n\n  function clearHighlights() {\n    firstLevelArrows.clear();\n    secondLevelArrows.clear();\n    highlightedNodes.clear();\n  }\n\n  function focusUI(ui) {\n    if (ui !== undefined) {\n      bus.fire('show-subreddit', ui.name);\n    }\n    let graph = options && options.getGraph && options.getGraph();\n    if (!ui && !moved && graph) {\n      clearHighlights();\n      bus.fire('show-subreddit', null);\n      scene.renderFrame();\n    }\n\n    moved = false;\n\n    if (ui) {\n      clearHighlights();\n\n      options.getHighlightedLinks(ui).forEach(linkUI => {\n        let links = linkUI.isFirstLevel ? firstLevelArrows : secondLevelArrows;\n        links.add(linkUI);\n      });\n      options.getHighlightedNodes(ui).forEach(nodeUI => highlightedNodes.add(nodeUI));\n\n      scene.renderFrame();\n    } \n  }\n\n  function addNode(ui) {\n    let position = ui.position;\n    let r = ui.size / 2;\n\n    spatialIndex.insert({\n      minX: position[0] - r,\n      minY: position[1] - r,\n      maxX: position[0] + r,\n      maxY: position[1] + r,\n      ui,\n    });\n  }\n\n  function dispose() {\n    scene.removeChild(firstLevelArrows);\n    scene.removeChild(secondLevelArrows);\n    scene.removeChild(highlightedNodes);\n\n    scene.off('click', handleClick);\n    scene.off('mousemove', handleMove);\n    scene.off('transform', handleTransform);\n  }\n\n  function handleClick(e) {\n    let ui = findNearest(e.x, e.y);\n    focusUI(ui);\n  }\n\n  function setPaused(newIsPaused) {\n    isPaused = newIsPaused;\n  }\n\n  function handleMove(e) {\n    if (isPaused) return;\n\n    let ui = findNearest(e.x, e.y);\n    if (ui !== undefined) {\n      bus.fire('show-tooltip', {\n        x: e.originalEvent.clientX,\n        y: e.originalEvent.clientY,\n        data: ui.name,\n      });\n      return;\n    }\n\n    bus.fire('show-tooltip', null);\n  }\n\n  function findNearest(x, y) {\n    const neighborIds = knn(spatialIndex, x, y, 1);\n    let neighbor = neighborIds[0];\n    if (neighbor === undefined) return;\n    let ui = neighbor.ui;\n\n    let [uiX, uiY] = ui.position;\n    let dist = Math.hypot(x - uiX, y - uiY);\n    if (dist < ui.size / 2) return ui;\n  }\n}","export default function getComplimentaryColor(color, lightningFactor = 1.4, alpha = 0xaa) {\n  let r = (color >> 24) & 0xff;\n  let g = (color >> 16) & 0xff;\n  let b = (color >> 8) & 0xff;\n  let [h, s, l] = rgbToHsl(r, g, b);\n  if (l > 0.5) lightningFactor = .8;\n  let [r0, g0, b0] = hslToRgb(h, s, Math.min(1, l * lightningFactor));\n  return (r0 << 24) | (g0 << 16) | (b0 << 8) | alpha;\n}\n\nfunction rgbToHsl(r, g, b) {\n  r /= 255, g /= 255, b /= 255;\n\n  var max = Math.max(r, g, b), min = Math.min(r, g, b);\n  var h, s, l = (max + min) / 2;\n\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n      case g: h = (b - r) / d + 2; break;\n      case b: h = (r - g) / d + 4; break;\n    }\n\n    h /= 6;\n  }\n\n  return [ h, s, l ];\n}\n\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n\n  if (s == 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1/3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1/3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n}\n\nfunction hue2rgb(p, q, t) {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  if (t < 1/6) return p + (q - p) * 6 * t;\n  if (t < 1/2) return q;\n  if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n  return p;\n}","import PointCollection from './PointCollection';\nimport TextCollection from './MSDFTextCollection';\nimport PolyLineCollection from './PolyLineCollection';\nimport {Colors, LayerLevels, NamedGroups} from './constants';\nimport createPointerEventsHandler from './createPointerEventsHandler';\nimport bus, {setProgress} from './bus';\nimport getComplimentaryColor from './getComplimentaryColor';\n\nconst createLayout = require('ngraph.forcelayout');\nconst FLOOR_COLOR = 0x5670B6ff;\nconst EDGE_COLOR = getComplimentaryColor(0x5670B6ff);\n\nconst Easing = {\n  easeInQuart(x) {\n    return x * x * x * x;\n  }\n}\n\nexport default function createSubgraphVisualizer(subgraph, viewBox, sceneLayerManager, nodeNameToUI) {\n  let layout;\n  let raf;\n  let MAX_FRAMES = 4000;\n  let renderCount = 0;\n  let moveThreshold = 0.1;\n  let prevSize = 0;\n\n  const ourNodeNameToUI = new Map();\n  const scene = sceneLayerManager.getScene();\n  const points = new PointCollection(scene.getGL());\n  const text = new TextCollection(scene.getGL());\n  const boundariesFill = new PolyLineCollection(scene.getGL(), {color: 0x124182a4, opacity: 1.0});\n  const transitionAnimator = createTransitionAnimator(sceneLayerManager, 60 * 0.2, viewBox);\n\n  // order is important. Pointer events should go after main elements\n  sceneLayerManager.addToLayer(boundariesFill, LayerLevels.Polygons);\n  sceneLayerManager.addToLayer(points, LayerLevels.Nodes);\n  sceneLayerManager.addToLayer(text, LayerLevels.Text);\n\n  // Now we are going to listen to events from the subgraph:\n  let pointerEvents = createPointerEventsHandler(sceneLayerManager, {\n    getGraph: () => renderCount < MAX_FRAMES && subgraph,\n    getHighlightedLinks,\n    getHighlightedNodes\n  });\n  bus.on('subgraph-focus-node', focusSubgraphNode);\n\n  return {\n    dispose,\n    getPointerEvents() {\n      return pointerEvents\n    },\n    getNameToUI() {\n      return ourNodeNameToUI\n    },\n    run\n  };\n\n\n  function focusSubgraphNode(name) {\n    pointerEvents.focusUI(ourNodeNameToUI.get(name));\n  }\n\n  function getHighlightedNodes(ui) {\n    const hlNode = {...ourNodeNameToUI.get(ui.name)};\n    hlNode.color = Colors.PRIMARY_HIGHLIGHT_COLOR ;\n    let nodeUIs = [hlNode];\n    subgraph.forEachLinkedNode(ui.name, (other) => {\n      const hlNode = {...ourNodeNameToUI.get(other.id)};\n      hlNode.color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n      nodeUIs.push(hlNode);\n    });\n\n    return nodeUIs;\n  }\n\n  function getHighlightedLinks(ui) {\n    let linkUIs = [];\n\n    subgraph.forEachLink(link => {\n      let isFirstLevel = (link.fromId === ui.name || link.toId === ui.name);\n      linkUIs.push({\n        from: ourNodeNameToUI.get(link.fromId).position,\n        to: ourNodeNameToUI.get(link.toId).position,\n        color: isFirstLevel ? 0xffffffff : EDGE_COLOR, \n        isFirstLevel\n      });\n    });\n\n    return linkUIs;\n  }\n\n  function dispose(onSceneIsBack) {\n    cancelAnimationFrame(raf);\n    bus.off('subgraph-focus-node', focusSubgraphNode);\n\n    text.parent.removeChild(text);\n    text.dispose();\n\n    pointerEvents.dispose();\n\n    transitionAnimator.startSceneRestoration(() => {\n      boundariesFill.parent.removeChild(boundariesFill);\n      points.parent.removeChild(points);\n      points.dispose();\n      if (onSceneIsBack) onSceneIsBack();\n    }, ourNodeNameToUI, nodeNameToUI, points, onSceneIsBack === undefined);\n    raf = null;\n    scene.renderFrame();\n  }\n\n  function run() {\n    transitionAnimator.startFadeOut();\n    beginLayout();\n    // transitionAnimator.startZoomOut(beginLayout);\n  }\n\n  function beginLayout() {\n    let minSize = Infinity;\n    let maxSize = -Infinity;\n    subgraph.forEachNode(node => {\n      let ui = nodeNameToUI.get(node.id);\n      if (!ui) throw new Error('Missing ui for node: ' + node.id);\n      if (ui.size < minSize) minSize = ui.size;\n      if (ui.size > maxSize) maxSize = ui.size;\n    });\n    moveThreshold = maxSize * 0.5;\n\n    layout = createLayout(subgraph, {\n      timeStep: maxSize / 20,\n      springLength: maxSize * 3,\n      springCoefficient: 1e-4,\n      gravity: -maxSize*100,\n      nodeMass(nodeId) {\n        let ui = nodeNameToUI.get(nodeId);\n        return ui.size;\n      }\n    });\n\n    rememberAndSetOriginalPositions();\n    raf = requestAnimationFrame(frame);\n  }\n\n  function frame() {\n    for (let i = 0; i < 10; ++i) layout.step();\n\n    let bboxSize = updateNodePositions();\n    let movedLength = Math.abs(prevSize - bboxSize);\n    prevSize = bboxSize;\n\n    if (movedLength > moveThreshold && renderCount++ < MAX_FRAMES) {\n      raf = requestAnimationFrame(frame);\n      if (renderCount % 10 === 0) {\n        setProgress(() => ({\n          message: `Layout step ${renderCount} of ${MAX_FRAMES}. Please wait...`\n        }));\n      }\n    } else {\n      finishRendering();\n    }\n\n    scene.setViewBox(getBoundingRect());\n\n    scene.renderFrame();\n  }\n\n  function getRootNodeId() {\n    let root = null;\n    subgraph.forEachNode(node => {\n      if (node.data && node.data.isRoot) {\n        root = node.id;\n        return true;\n      }\n    });\n    if (!root) {\n      throw new Error('Root node is missing in the subgraph');\n    }\n    return root;\n  }\n\n  function finishRendering() {\n    let points = [];\n    subgraph.forEachNode(node => {\n      let {x, y} = layout.getNodePosition(node.id);\n      points.push([x, y]);\n      let ui = ourNodeNameToUI.get(node.id);\n      pointerEvents.addNode(ui);\n      text.addText({\n        x,\n        y: y - ui.size * 0.75,\n        text: ui.name,\n        limit: 2. * ui.size,\n        cx: 0.5,\n      });\n    });\n\n    let rootNode = getRootNodeId();\n    pointerEvents.focusUI(ourNodeNameToUI.get(rootNode));\n    setProgress(() => ({\n      subgraphDone: true,\n      subgraphName: rootNode\n    }));\n    import('concaveman').then(concaveman => {\n      var polygon = concaveman.default(points);\n      boundariesFill.addPolygon({polygon, color: FLOOR_COLOR})\n      scene.renderFrame();\n    })\n  }\n\n  function getBoundingRect() {\n    let boundingRect = {\n      left: Infinity,\n      right: -Infinity,\n      top: Infinity,\n      bottom: -Infinity\n    }\n    subgraph.forEachNode(node => {\n      let {x, y} = layout.getNodePosition(node.id);\n      if (x < boundingRect.left) boundingRect.left = x;\n      if (x > boundingRect.right) boundingRect.right = x;\n      if (y < boundingRect.top) boundingRect.top = y;\n      if (y > boundingRect.bottom) boundingRect.bottom = y;\n    });\n    return boundingRect;\n  }\n\n  function updateNodePositions() {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n\n    subgraph.forEachNode(node => {\n      let pos = layout.getNodePosition(node.id);\n      let ui = ourNodeNameToUI.get(node.id);\n\n      ui.position[0] = pos.x;\n      ui.position[1] = pos.y;\n      if (pos.x < minX) minX = pos.x;\n      if (pos.x > maxX) maxX = pos.x;\n      if (pos.y < minY) minY = pos.y;\n      if (pos.y > maxY) maxY = pos.y;\n      points.update(ui.id, ui);\n    });\n    let w = maxX - minX;\n    let h = maxY - minY;\n    return w * h;\n  }\n\n  function rememberAndSetOriginalPositions() {\n    let minSize = Infinity;\n    let maxSize = -Infinity;\n    subgraph.forEachNode(node => {\n      let ui = nodeNameToUI.get(node.id);\n      if (!ui) throw new Error('Missing ui for node: ' + node.id);\n      // let isRoot = node.data && node.data.isRoot;\n      let pos = copyPosition(ui.position);\n      let color = Colors.TERNARY_COLOR;\n      // if (isRoot) color = Colors.PRIMARY_HIGHLIGHT_COLOR;\n      // else if (node.data && node.data.isFirstChild) color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n\n      let ourUI = {\n        position: pos,\n        color,\n        size: ui.size,\n        id: ourNodeNameToUI.size,\n        name: ui.name,\n      };\n      if (ourUI.size < minSize) minSize = ourUI.size;\n      if (ourUI.size > maxSize) maxSize = ourUI.size;\n      ourNodeNameToUI.set(ui.name, ourUI);\n      points.add(ourUI);\n      layout.setNodePosition(node.id, pos[0], pos[1])\n    });\n  }\n\n}\n\nfunction createTransitionAnimator(sceneLayerManager, durationInFrames, zoomOutViewBox) {\n  let elapsed = 0;\n  let raf;\n  let currentStep;\n  let zoomStart, zoomEnd, changeRectangleFinishedCallback;\n  let doneCallback;\n  let positions, nodeUIs;\n  const scene = sceneLayerManager.getScene();\n\n  return {\n    startZoomOut,\n    startZoomIn,\n    startFadeOut,\n    startSceneRestoration,\n    dispose() {\n      cancelAnimationFrame(raf);\n    }\n  }\n\n  function startZoomOut(cb) {\n    elapsed = 0;\n    zoomStart = getCurrentBoundingRectangle();\n    let {width, height, top, left} = zoomOutViewBox;\n    zoomEnd = {\n      top, \n      left,\n      right: left + width,\n      bottom: top + height\n    };\n\n    currentStep = changeRectangle;\n    changeRectangleFinishedCallback = () => {\n      startFadeOut();\n      cb();\n    };\n\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n  }\n\n  function startZoomIn(boundingRect, doneCallback) {\n    currentStep = changeRectangle;\n    elapsed = 0;\n    zoomStart = getCurrentBoundingRectangle();\n    zoomEnd = boundingRect;\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n    changeRectangleFinishedCallback = null;\n    if (doneCallback) {\n      changeRectangleFinishedCallback = doneCallback;\n    }\n  }\n\n  function getCurrentBoundingRectangle() {\n    let dc = scene.getDrawContext();\n    const {position} = dc.view;\n    let side = position[2] * Math.tan(dc.fov / 2) / dc.pixelRatio;\n    return {\n      left: position[0] - side, \n      right: position[0] + side, \n      top: position[1] - side, \n      bottom: position[1] + side\n    };\n  }\n\n  function startFadeOut() {\n    sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n      el.opacity = 0;\n    });\n    sceneLayerManager.hideNamedGroup(NamedGroups.MainGraph);\n  }\n\n  function startSceneRestoration(done, current, target, nodeCollections, immediate) {\n    if (immediate) {\n      // TODO: this is ugly. Please refactor.\n      sceneLayerManager.restoreNamedGroup(NamedGroups.MainGraph);\n      sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n        el.opacity = 1;\n      });\n      done();\n      return;\n    }\n    elapsed = 0;\n    currentStep = fadeIn;\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n    doneCallback = done;\n\n    nodeUIs = nodeCollections;\n    positions = [];\n    current.forEach((ui, name) => {\n      positions.push({\n        ui,\n        from: copyPosition(ui.position),\n        to: target.get(name).position\n      });\n    })\n  }\n\n  function frame() {\n    if (elapsed >= durationInFrames) {\n      elapsed = durationInFrames;\n      currentStep(1);\n      return;\n    } \n\n    raf = requestAnimationFrame(frame);\n    currentStep(elapsed / durationInFrames);\n    elapsed += 1;\n  }\n\n  function changeRectangle(x) {\n    if (x === 1) {\n      if (changeRectangleFinishedCallback) changeRectangleFinishedCallback();\n      changeRectangleFinishedCallback = null;\n      return;\n    }\n\n    scene.setViewBox({\n      top: lerp(zoomStart.top, zoomEnd.top, x),\n      left: lerp(zoomStart.left, zoomEnd.left, x),\n      right: lerp(zoomStart.right, zoomEnd.right, x),\n      bottom: lerp(zoomStart.bottom, zoomEnd.bottom, x)\n    });\n    scene.renderFrame();\n  }\n\n  function lerp(from, to, t) {\n    return to * t + from * (1 - t);\n  }\n\n  function fadeIn(x) {\n    if (x === 0) {\n      // we we just start - let's bring back all nodes from original scene\n      // Their opacity is 0.\n      sceneLayerManager.restoreNamedGroup(NamedGroups.MainGraph);\n    }\n    // we will be changing opacity back to normal:\n    let opacity = Easing.easeInQuart(x);\n    sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n      el.opacity = opacity;\n    });\n    positions.forEach(node => {\n      let ui = node.ui;\n      ui.position[0] = lerp(node.from[0], node.to[0], x);\n      ui.position[1] = lerp(node.from[1], node.to[1], x);\n      nodeUIs.update(ui.id, ui);\n    });\n    sceneLayerManager.getScene().renderFrame();\n\n    if (x === 1 && doneCallback) {\n      // all is done, let's notify the client\n      doneCallback();\n    }\n  }\n}\n\nfunction copyPosition(pos) {\n  return [pos[0], pos[1], pos[2]];\n}","export default function createSceneLayerManager(scene) {\n  // Allows clients to hide/restore multiple elements at once:\n  const namedGroups = new Map(); // string -> {elements: Element[], isHidden: Boolean}\n\n  return {\n    addToLayer,\n    addToNamedGroup,\n    hideNamedGroup,\n    restoreNamedGroup,\n    getNamedGroup: (groupName) => namedGroups.get(groupName),\n    getScene: () => scene\n  };\n\n  function restoreNamedGroup(groupName) {\n    let group = namedGroups.get(groupName);\n    if (group === undefined) throw new Error('No such group: ' + groupName);\n    if (!group.isHidden) return; // already restored\n    group.isHidden = false;\n    group.elements.forEach(element => {\n      // put it back to the previous z-index\n      addToLayer(element, element.layer);\n    });\n  }\n\n  function addToNamedGroup(element, groupName) {\n    let group = namedGroups.get(groupName);\n    if (group === undefined) {\n      group = {\n        elements: [],\n        isHidden: false\n      }\n      namedGroups.set(groupName, group);\n    }\n    // Note: it's your responsibility to avoid duplicates\n    group.elements.push(element);\n  }\n\n  function hideNamedGroup(groupName) {\n    let group = namedGroups.get(groupName);\n    if (!group) {\n      throw new Error('No group with such name: ' + groupName);\n    }\n\n    if (group.isHidden) return; // already hidden;\n    group.isHidden = true;\n    group.elements.forEach(element => {\n      if (element.parent) element.parent.removeChild(element);\n    });\n  }\n\n  function addToLayer(element, layerIndex) {\n    element.layer = layerIndex\n    let rootElement = scene.getRoot();\n    let lastElementWithLowerLayerIndex = null;\n    rootElement.children.forEach(el => {\n      let layer = el.layer;\n      if (layer === undefined) {\n        // z-index may not be correct!\n        console.warn('Scene element without layer index', layer);\n        layer = 0;\n      }\n      if (layer <= layerIndex) {\n        lastElementWithLowerLayerIndex = el;\n      }\n    });\n    if (lastElementWithLowerLayerIndex) {\n      rootElement.insertChildAfter(element, lastElementWithLowerLayerIndex);\n    } else {\n      // none of the existing layers is lower than our own layer index,\n      // send us to the very back:\n      rootElement.appendChild(element, /* sendToBack */ true);\n    }\n  }\n}","import {GLCollection, defineProgram, ColorAttribute} from 'w-gl';\n\nconst tex = [\n  [0, 0],\n  [1, 0],\n  [1, 1],\n  [1, 1],\n  [0, 1],\n  [0, 0]\n]\nexport class BoxCollection extends GLCollection {\n  constructor(gl, options) {\n    let program = defineProgram({\n      gl,\n      capacity: options.capacity,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  attribute vec3 point;\n  attribute vec2 texCoordinate;\n  attribute vec4 color;\n  varying vec3 vPoint;\n  varying vec2 vTex;\n  varying vec4 vColor;\n\n  void main() {\n    vec4 pos = modelViewProjection * vec4(point, 1.0);\n    gl_Position = pos;\n    vPoint = point;\n    vTex = texCoordinate;\n    vColor = color.abgr;\n  }`,\n\n      fragment: `\n      precision highp float;\n      uniform vec3 camera;\n      varying vec3 vPoint;\n      varying vec2 vTex;\n      varying vec4 vColor;\n\n      void main() {\n        vec4 col = vec4(0);\n        col += length(smoothstep(0.48, 0.5, abs(vTex - 0.5)));\n        col += vColor;\n        col[3] = 0.7;\n        gl_FragColor = col;\n      }`,\n\n        attributes: {\n          color: new ColorAttribute(),\n        },\n        preDrawHook(/* programInfo */) {\n          return `\n          // gl.disable(gl.BLEND);\n          gl.enable(gl.DEPTH_TEST);\n          gl.depthFunc(gl.LEQUAL);\n          `;\n        },\n        postDrawHook() {\n          return `\n          //gl.enable(gl.BLEND);\n           gl.disable(gl.DEPTH_TEST);\n           `;\n        },\n    });\n    super(program);\n\n    this.uiIDToUI = new Map();\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        camera: drawContext.view.position\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.program.draw(this.uniforms);\n  }\n\n  setColor(box, color){\n    this.setFaceColor(box.front, color);\n    this.setFaceColor(box.left, color);\n    this.setFaceColor(box.right, color);\n    this.setFaceColor(box.back, color);\n  }\n\n  setFaceColor(face, color) {\n    face.forEach(point => {\n      point.color = color;\n      this.update(point.uiId, point);\n    })\n  }\n\n  addBox(box) {\n    let frontUI, leftUI, rightUI, backUI, topUI;\n    let front = this.getFace(box.width, box.height);\n    this.rotateFace(front, Math.PI/2, 'x')\n    this.translateFace(front, [0, 0, box.height/2]);\n    this.rotateFace(front, Math.PI/2, 'z')\n    this.translateFace(front, [box.x+box.width/2,box.y, 0]);\n    //this.translateFace(front, [box.x, box.y, 0]);\n    frontUI = this.addFace(front);\n    frontUI.name = 'front';\n\n    let left = this.getFace(box.width, box.height);\n    this.rotateFace(left, Math.PI/2, 'x')\n    this.translateFace(left, [0, 0, box.height / 2]);\n    this.translateFace(left, [0, -box.width/2, 0]);\n    this.translateFace(left, [box.x, box.y, 0]);\n    leftUI = this.addFace(left);\n    leftUI.name = 'left';\n\n    let right = this.getFace(box.width, box.height);\n    this.rotateFace(right, Math.PI/2, 'x')\n    this.translateFace(right, [0, 0, box.height / 2]);\n    this.rotateFace(right, Math.PI, 'z')\n    this.translateFace(right, [0, box.width/2, 0]);\n    this.translateFace(right, [box.x, box.y, 0]);\n    rightUI = this.addFace(right);\n    rightUI.name = 'right';\n\n    let back = this.getFace(box.width, box.height);\n    this.rotateFace(back, Math.PI/2, 'x')\n    this.translateFace(back, [0, 0, box.height/2]);\n    this.rotateFace(back, -Math.PI/2, 'z')\n    this.translateFace(back, [-box.width/2,0, 0]);\n    this.translateFace(back, [box.x, box.y, 0]);\n    backUI = this.addFace(back);\n    backUI.name = 'back';\n\n    let top = this.getFace(box.width, box.width);\n    this.translateFace(top, [box.x, box.y, box.height]);\n    topUI = this.addFace(top);\n\n    return {\n      front: frontUI,\n      left: leftUI,\n      right: rightUI,\n      back: backUI,\n      top: topUI\n    }\n  }\n\n  removeBox(box) {\n    this.removeFace(box.front);\n    this.removeFace(box.left);\n    this.removeFace(box.right);\n    this.removeFace(box.back);\n  }\n\n  translateFace(face, d) {\n    face.forEach(point => {\n      point[0] += d[0];\n      point[1] += d[1];\n      point[2] += d[2];\n    });\n  }\n\n  rotateFace(face, angle, axis) {\n    let c = Math.cos(angle), s = Math.sin(angle);\n    face.forEach(point => {\n      let [x, y, z] = point;\n      let x0, y0, z0;\n      if (axis === 'z') {\n        x0 = c * x - s * y;\n        y0 = s * x + c * y;\n        z0 = z;\n      } else if (axis === 'y') {\n        x0 = x * c + z * s;\n        y0 = y;\n        z0 = -x * s + z * c;\n      }  else if (axis === 'x') {\n        x0 = x;\n        y0 = y * c - z * s;\n        z0 = y * s + z * c;\n      } else {\n        throw new Error('Not supported axis ' + axis);\n      }\n      point[0] = x0;\n      point[1] = y0;\n      point[2] = z0;\n    })\n  }\n\n  getFace(width, height) {\n    return [\n      [ - width/2, - height/2, 0], // (0, 0)\n      [ + width/2, - height/2, 0], // (1, 0)\n      [ + width/2, + height/2, 0], // (1, 1)\n\n      [ + width/2, + height/2, 0], // (1, 1)\n      [ - width/2, + height/2, 0], // (0, 1)\n      [ - width/2, - height/2, 0], // (0, 0)\n    ];\n  }\n\n  addFace(quadPoints) {\n    return quadPoints.map((point, i) => {\n      let ui = {\n        point,\n        uiId: -1,\n        color: 0x292C33ff,\n        texCoordinate: tex[i]\n      };\n      ui.uiId = this.add(ui);\n      this.uiIDToUI.set(ui.uiId, ui);\n      return ui;\n    })\n  }\n\n  removeFace(quadUI) {\n    quadUI.forEach(ui => {\n      let oldId = ui.uiId;\n      let newId = this.remove(oldId);\n      let movedUI = this.uiIDToUI.get(newId);\n      if(!movedUI) {\n        throw new Error(\"Missing ui element\");\n      }\n      this.uiIDToUI.delete(newId);\n      if (newId !== oldId) {\n        movedUI.uiId = oldId;\n        this.uiIDToUI.set(oldId, movedUI);\n      }\n    })\n  }\n\n  clear() {\n    throw new Error('Not implemented');\n  }\n}\n","import { fpsControls, mapControls, createFPSControlsUI, DomElement, DomContainer } from 'w-gl';\nimport { BoxCollection } from './BoxCollection';\nimport {quat, mat4, vec3} from 'gl-matrix';\nimport knn from 'rbush-knn';\nimport bus, { setProgress } from './bus';\nimport { formatNumber } from './utils';\n\nexport default function createStreetView(scene, spatialIndex, nameToUI, subreddit, viewBox) {\n  let api = {\n    enter, \n    exit, \n    dispose,\n    lookAt\n  };\n  let fpsUI;\n  let boxes, items, asyncRender;\n  let visibleBoxes = new Set();\n  let visibilityUpdate = 0;\n  let uiToBox = new Map();\n  let visibleElements = new Map();\n  let lastVisibilityUpdate = 0;\n  let domContainer = new DomContainer({seeThrough: true});\n\n  return api;\n\n  function lookAt(name) {\n    let node = nameToUI.get(name);\n    if (!node) return;\n\n    let [x, y] = node.position;\n    let size = node.size || 10;\n    let a = Math.tan(scene.getDrawContext().fov/2);\n    let cameraController = scene.getCameraController();\n    cameraController.lookAt(\n      [x, y - 2*size/a, 4],\n      [x, y, size], \n    );\n  }\n\n  function dispose() {\n    cancelAnimationFrame(asyncRender);\n    asyncRender = 0;\n    clearTimeout(visibilityUpdate);\n    scene.removeChild(boxes);\n    scene.removeChild(domContainer);\n  }\n\n  function enter() {\n    let cameraController = scene.setCameraController(fpsControls);\n    lookAt(subreddit);\n\n    let minDimension = Math.min(viewBox.width, viewBox.height);\n    let moveSpeed = minDimension / 100000;\n    if (!Number.isFinite(moveSpeed)) moveSpeed = 0.1;\n\n    cameraController.setMoveSpeed(moveSpeed).setScrollSpeed(moveSpeed * 10).setFlySpeed(moveSpeed / 5).enableMouseCapture(true);\n    fpsUI = createFPSControlsUI(document.body, cameraController);\n\n    items = spatialIndex.all();\n    boxes = new BoxCollection(scene.getGL(), {\n      capacity: items.length * 5 * 6\n    });\n    scene.appendChild(boxes);\n    scene.appendChild(domContainer);\n\n    renderFirstBatch(subreddit);\n    scheduleVisibilityUpdate();\n  }\n\n  function renderFirstBatch(name) {\n    let node = nameToUI.get(name);\n    if (!node) return;\n\n    let [x, y] = node.position;\n    let neighbors = knn(spatialIndex, x, y, 60);\n    neighbors.forEach(item => {\n      let ui = item.ui;\n      let [x, y] = ui.position;\n      let box = boxes.addBox({\n        x, y,\n        width: ui.size,\n        height: ui.size * 2\n      });\n      uiToBox.set(ui, box);\n    });\n\n    renderTheRest();\n  }\n\n  function renderTheRest() {\n    let index = 0;\n    asyncRender = requestAnimationFrame(processNext);\n\n    function processNext() {\n      let localCount = 0;\n      while (index < items.length && localCount < 1000) {\n        let item = items[index];\n        let ui = item.ui;\n        index += 1;\n\n        if (uiToBox.has(ui)) continue; // processed in the first batch;\n\n        let [x, y] = ui.position;\n        let box = boxes.addBox({\n          x, y,\n          width: ui.size,\n          height: ui.size * 2\n        });\n        uiToBox.set(ui, box);\n        localCount += 1;\n      }\n\n      scene.renderFrame();\n\n      if (index < items.length) {\n        setProgress(() => ({\n          message: 'Initializing street view: ' + formatNumber(index) + '/' + formatNumber(items.length)\n        }));\n        asyncRender = requestAnimationFrame(processNext);\n      } else {\n        // all rendered!\n        setProgress(() => ({\n          streetViewDone: true,\n        }));\n        scene.on('transform', handleTransform);\n        // scheduleVisibilityUpdate();\n        asyncRender = 0;\n      }\n    }\n  }\n\n  function exit() {\n    visibleElements.forEach((el, name) => hideElement(name));\n\n    fpsUI.dispose();\n    scene.off('transform', handleTransform);\n    scene.setCameraController(mapControls);\n    scene.removeChild(boxes);\n  }\n\n  function showElement(face, name) {\n    let el = visibleElements.get(name);\n    if (!el || face !== el.face) {\n      if (el && el.face) {\n        // boxes.setFaceColor(el.face, 0x606060ff);\n        domContainer.removeChild(el.dom);\n      }\n      let a = face[0].point;\n      let b = face[1].point;\n      let c = face[2].point;\n\n      let dx = b[0] - a[0];\n      let dy = b[1] - a[1];\n      let l = Math.sqrt(dx * dx + dy * dy);\n      let dom = new DomElement({width: '400px',  height: '800px'});\n      let scale = l/400; // assume 400 px for dom element width\n\n      // center of the face\n      let ox = (a[0] + b[0]) / 2;\n      let oy = (a[1] + b[1]) / 2;\n      let oz = (a[2] + c[2]) / 2;\n\n      // face normal\n      let n = vec3.cross([], [b[0] - a[0], b[1] - a[1], b[2] - a[2]], [c[0] - a[0], c[1] - a[1], c[2] - a[2]])\n      normalize(n, n);\n      // rotate the dom plane normal ([0, 0, 1]) to match face normal\n      let q = quat.rotationTo([], [0, 0, 1], n);\n      // Rotation above is not unique, so we manually rotate dom plane until it aligns with \n      // logical box placement. This probably could be done easier, I just don't know how yet:\n      if (face.name === 'back') {\n        quat.rotateZ(q, q, -Math.PI/2)\n      } else if (face.name === 'front') {\n        quat.rotateZ(q, q, Math.PI/2)\n      } else if (face.name === 'right') {\n        quat.rotateZ(q, q, Math.PI)\n      }\n\n      mat4.fromRotationTranslationScale(dom.model, q,  [ox, oy, oz], [scale, scale, scale]);\n      dom.worldTransformNeedsUpdate = true;\n      bus.fire('append-dom', {name: name, dom: dom.el})\n      domContainer.appendChild(dom)\n\n      visibleElements.set(name, {face, dom});\n    } \n  }\n  function hideElement(name) {\n    let el = visibleElements.get(name);\n    if (el) {\n      bus.fire('remove-dom', {name: name, dom: el.dom.el})\n      domContainer.removeChild(el.dom);\n      visibleElements.delete(name);\n    }\n  }\n\n  function handleTransform(e) {\n    let dc = e.drawContext;\n    let z = dc.view.position[2];\n    if(z < 10) {\n      dc.view.position[2] = 10;\n      e.updated = true;\n    }\n    // let moveSpeed = 3+smoothStep(0, 3000, z) * 14;\n    // scene.getCameraController().setMoveSpeed(moveSpeed);\n    scheduleVisibilityUpdate();\n  }\n\n  function scheduleVisibilityUpdate() {\n    clearTimeout(visibilityUpdate);\n    let now = window.performance.now();\n    let elapsed = now - lastVisibilityUpdate;\n    if (elapsed < 500) {\n      visibilityUpdate = setTimeout(updateVisibility, elapsed);\n    } else {\n      updateVisibility();\n    }\n  }\n\n  function updateVisibility() {\n    lastVisibilityUpdate = window.performance.now();\n\n    let dc = scene.getDrawContext();\n\n    let eye = dc.view.position;\n    let center = dc.view.center;\n    let lookDirection = getDirection(eye, center);\n    let neighbors = getMostVisibleNeighbors(eye, lookDirection, /* maxNeighbors =*/ 10, /* maxAngle =*/ 35);\n    neighbors = neighbors.map(n => {\n      let dx = n.ui.position[0] - eye[0];\n      let dy = n.ui.position[1] - eye[1];\n      let dist = (dx * dx + dy * dy);\n      return {\n        ui: n.ui,\n        size: n.ui.size,\n        dist \n      }\n    }).sort((a, b) => {\n      return b.size/b.dist - a.size/a.dist; //b.ui.size - a.ui.size\n    }).slice(0, 4);\n    if (!neighbors.length) return;\n\n    let nowVisible = new Set();\n    neighbors.forEach(box => {\n      if (uiToBox.has(box.ui)) {\n        // we might not have finished rendering yet.\n        nowVisible.add(box.ui);\n      }\n    });\n    visibleBoxes.forEach(ui => {\n      if (!nowVisible.has(ui)) {\n        hideElement(ui.name);\n      }\n    });\n\n    let intersections = [];\n    nowVisible.forEach(ui => {\n      let box = uiToBox.get(ui);\n      if(!box) {\n        throw new Error('missing ui');\n      }\n\n      let minT = Infinity;\n      let minFace = box.front;\n      minT = checkFaceIntersection(box, box.front);\n\n      let t = checkFaceIntersection(box, box.back);\n      if (t < minT) { minT = t; minFace = box.back; }\n\n      t = checkFaceIntersection(box, box.left);\n      if (t < minT) { minT = t; minFace = box.left; }\n\n      t = checkFaceIntersection(box, box.right);\n      if (t < minT) { minT = t; minFace = box.right; }\n\n      if (Number.isFinite(minT)) intersections.push({t: minT, face: minFace, name: ui.name});\n    });\n\n    visibleBoxes = nowVisible;\n    intersections.sort((a, b) => a.t - b.t)\n    let count = Math.min(10, intersections.length);\n    for (let i = 0; i< count; ++i) {\n      showElement(intersections[i].face, intersections[i].name);\n    }\n    scene.renderFrame();\n\n    function checkFaceIntersection(box, face) {\n      let a = face[0].point;\n      let b = face[1].point;\n      return castRay(eye, a, b);\n    }\n\n    function castRay(from, a, b) {\n      let [r_px, r_py] = from;\n      let [s_px, s_py] = a;\n      let s_dx = b[0] - a[0];\n      let s_dy = b[1] - a[1];\n      let cx = s_px + 0.5*s_dx;\n      let cy = s_py + 0.5*s_dy;\n      let [r_dx, r_dy] = getDirection(from, [cx, cy]); \n      let t2 = (r_dx*(s_py-r_py) + r_dy*(r_px-s_px))/(s_dx*r_dy - s_dy*r_dx)\n      let ta = (s_px+s_dx*t2-r_px)/r_dx;\n      if (Number.isNaN(ta)) return 0; // ray is directly on the segment?\n      if (ta < 0) ta = Infinity; // Point is behind us\n      return ta;\n    }\n  }\n\n  function getDirection(from, to) {\n    let dir = [to[0] - from[0], to[1] - from[1]];\n    let l = Math.sqrt(dir[0]*dir[0] + dir[1] * dir[1]);\n    if (l < 1e-3) return;\n    dir[0] /= l; dir[1] /= l;\n    return dir;\n  }\n\n  function getMostVisibleNeighbors(eye, lookDirection, maxCount, maxAngle) {\n    if (!lookDirection) return []; // looking down?\n\n    // not only we find N nearest boxes, we also filter them so that\n    // only those in front of the camera are selected\n    return knn(spatialIndex, eye[0], eye[1], maxCount, checkAngle);\n\n    function checkAngle(candidate) {\n      let x = (candidate.minX + candidate.maxX)/2;\n      let y = (candidate.minY + candidate.maxY)/2;\n      let candidateDirection = getDirection(eye, [x, y])\n      if (!candidateDirection) return false;\n\n      // We take a dot product of two unit vectors which is equal to\n      // the cosine of angle between them. This lets us measure angle\n      // between the vector where camera looks and where the candidate is.\n      // If that angle is too big - we ignore the candidate.\n\n      let dot = lookDirection[0] * candidateDirection[0] + lookDirection[1] * candidateDirection[1];\n      let angle = Math.acos(dot); // no need to divide, as we are normalized\n      return angle < maxAngle * Math.PI / 180;\n    }\n  }\n}\n\nfunction normalize(out, a) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  let len = x * x + y * y + z * z;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}","import { createScene } from 'w-gl';\nimport createSVGLoader from './createSVGLoader';\nimport {getPointsFromPathData, getElementFillColor} from 'streaming-svg-parser';\nimport PointCollection from './PointCollection';\nimport PolyLineCollection from './PolyLineCollection';\nimport TextCollection from './MSDFTextCollection';\nimport ColoredTextCollection from './ColoredTextCollection';\nimport bus, {setProgress} from './bus';\nimport createFuzzySearcher from './createFuzzySearcher';\nimport {debounce, formatNumber} from './utils'\nimport appState from '../appState';\nimport createGraph from 'ngraph.graph';\nimport createSubgraphVisualizer from './createSubgraphVisualizer';\nimport createPointerEventsHandler from './createPointerEventsHandler';\nimport createSceneLayerManager from './createSceneLayerManager';\nimport {Colors, LayerLevels, NamedGroups} from './constants';\nimport createStreetView from './createStreetView';\nimport getComplimentaryColor from './getComplimentaryColor';\n\nexport default function createStreamingSVGRenderer(canvas) {\n  let ignoreSVGViewBox = false;\n  let isStreetView = false;\n  let preStreetViewCameraPosition;\n  let inputTarget;\n  let streetView;\n  let scene = initScene();\n  let fuzzySearcher = createFuzzySearcher();\n  window.fuzzySearcher = fuzzySearcher; // TODO: Don't use window.\n\n  let persistedName = appState.query;\n  let nodes = new PointCollection(scene.getGL());\n  let boundariesFill = new PolyLineCollection(scene.getGL(), {color: 0x124182a4, opacity: 1.0});\n\n  let text = new TextCollection(scene.getGL());\n  let labelsText = new ColoredTextCollection(scene.getGL());\n\n  let loader;\n  let viewBox;\n  let currentTransform = createTransformParser();\n  let positions = [];\n\n  const nodeNameToUI = new Map();\n  const nodesByComponent = new Map();\n  const complimentaryColor = new Map();\n  const clusterColors = new Map();\n\n  const setProgressDebounced = debounce(setProgress, 100, window);\n  let subgraphVisualizer;\n  const sceneLayerManager = createSceneLayerManager(scene);\n\n  sceneLayerManager.addToLayer(boundariesFill, LayerLevels.Polygons);\n  sceneLayerManager.addToLayer(nodes, LayerLevels.Nodes);\n  sceneLayerManager.addToLayer(text, LayerLevels.Text);\n  sceneLayerManager.addToLayer(labelsText, LayerLevels.Labels)\n\n  sceneLayerManager.addToNamedGroup(boundariesFill, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(nodes, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(text, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(labelsText, NamedGroups.MainGraph);\n\n  // This is our bread and butter for touch/mouse event handling\n  const pointerEvents = createPointerEventsHandler(sceneLayerManager, {\n    elementsGroupName: NamedGroups.MainGraph,\n    onTransform: () => {\n      // we don't want to update the query string when subgraph is active\n      if (subgraphVisualizer) return;\n\n      appState.saveScenePosition(scene);\n    },\n    getGraph: () => loader && loader.getGraph(),\n    getHighlightedNodes,\n    getHighlightedLinks,\n  });\n\n  bus.on('focus-node', focusNode);\n  bus.on('unfocus', unfocus);\n  bus.on('exit-subgraph', exitSubgraphMode);\n\n  return {\n    loadSVG,\n    focus() {\n      canvas.focus();\n    },\n    isStreetViewMode() {\n      return isStreetView\n    },\n    dispose,\n    showRelated,\n    showStreetView,\n    exitStreetView,\n    getNeighbors,\n    getGraph,\n    getScene() {\n      return scene;\n    },\n  };\n\n  function getHighlightedNodes(ui) {\n    let graph = loader && loader.getGraph();\n    if (!graph) return [];\n\n    const neighbors = nodesByComponent.get(ui.componentId);\n    const hlNode = {...nodeNameToUI.get(ui.name)};\n    hlNode.color = Colors.PRIMARY_HIGHLIGHT_COLOR ;\n    let nodeUIs = [hlNode];\n    graph.forEachLinkedNode(ui.name, (other) => {\n      const hlNode = {...nodeNameToUI.get(other.id)};\n      hlNode.color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n      nodeUIs.push(hlNode);\n      if (!neighbors.has(other.id)) return;\n    });\n\n    return nodeUIs;\n  }\n\n  function getHighlightedLinks(ui) {\n    let graph = loader && loader.getGraph();\n    if (!graph) return [];\n\n    let maxLinks = 10;\n    let neighbors = nodesByComponent.get(ui.componentId);\n    let secondaryLinkColor = complimentaryColor.get(ui.componentId);\n    let idx;\n    let linkUIs = [];\n\n    neighbors.forEach((neighborId) => {\n      idx = 0;\n      graph.forEachLinkedNode(neighborId, (other) => {\n        if (!neighbors.has(other.id)) return;\n        let isFirstLevel = neighborId === ui.name || other.id === ui.name;\n        if (idx > maxLinks && !isFirstLevel) return;\n        linkUIs.push({\n          from: nodeNameToUI.get(neighborId).position,\n          to: nodeNameToUI.get(other.id).position,\n          color: isFirstLevel ? 0xffffffff : secondaryLinkColor, \n          isFirstLevel\n        });\n        idx += 1;\n      });\n    });\n\n    return linkUIs;\n  }\n\n  function showStreetView(subreddit) {\n    subreddit = subreddit.split('+').map(x => x.trim())[0];\n    // sceneLayerManager.hideNamedGroup(NamedGroups.MainGraph);\n    // let graph = loader.getGraph();\n    // let node = graph.getNode(subreddit);\n    isStreetView = true;\n    let currentPointerEvents = subgraphVisualizer ? subgraphVisualizer.getPointerEvents() : pointerEvents;\n    if (!streetView) {\n      let nameToUI = subgraphVisualizer ? subgraphVisualizer.getNameToUI() : nodeNameToUI;\n      streetView = createStreetView(\n        scene, \n        currentPointerEvents.getIndex(), \n        nameToUI, \n        subreddit,\n        viewBox\n      );\n    }\n    nodes.hide();\n    currentPointerEvents.setPaused(true); // let the street view to handle the events\n    preStreetViewCameraPosition = scene.getDrawContext().view.position[2];\n    streetView.enter();\n  }\n\n  function exitStreetView() {\n    nodes.show();\n    streetView.exit();\n    streetView.dispose();\n    streetView = null;\n\n    scene.getDrawContext().view.position[2] = preStreetViewCameraPosition;\n    scene.getCameraController().setViewBox();\n    let currentPointerEvents = subgraphVisualizer ? subgraphVisualizer.getPointerEvents() : pointerEvents;\n    currentPointerEvents.setPaused(false);\n    isStreetView = false;\n    if (inputTarget) inputTarget.focus();\n  }\n\n  function lookAtNode(subreddit) {\n    if (isStreetView) {\n      streetView.lookAt(subreddit);\n    } else {\n      let node = nodeNameToUI.get(subreddit);\n      if (!node) return;\n\n      let [x, y] = node.position;\n      let size = node.size || 10;\n      size *= 2;\n      scene.setViewBox({\n        left: x - size,\n        top: y - size,\n        right: x + size,\n        bottom: y + size,\n      });\n\n      return node;\n    }\n  }\n\n  function getGraph() {\n    return loader.getGraph();\n  }\n\n  function getNeighbors(subreddit) {\n    let graph = loader.getGraph();\n    let neighbors = [];\n\n    graph.forEachLinkedNode(subreddit, otherNode => {\n      neighbors.push(otherNode.id);\n    });\n\n    return neighbors;\n  }\n\n  function showRelated(subreddit) {\n    let subgraph = createGraph();\n    subgraph.addNode(subreddit, {isRoot: true});\n\n    let graph = loader.getGraph();\n    let subgraphNodes = new Set();\n    addNeighbors(subreddit, subgraphNodes);\n\n    Array.from(subgraphNodes).forEach(node => {\n      addNeighbors(node, subgraphNodes);\n    });\n\n    subgraphNodes.forEach(node => {\n      let addedNode = subgraph.getNode(node);\n      if (!addedNode || !addedNode.data) {\n        let isFirstChild = !!(graph.hasLink(node, subreddit) || graph.hasLink(subgraph, node));\n        subgraph.addNode(node, {\n          isFirstChild,\n          size: nodeNameToUI.get(node).size,\n        });\n      }\n\n      graph.forEachLinkedNode(node, (otherNode, link) => {\n        if (!subgraphNodes.has(otherNode.id)) return;\n        if (subgraph.hasLink(link.fromId, link.toId)) return;\n\n        let isRootLevel = (link.fromId === subreddit) || (link.toId === subreddit);\n        subgraph.addLink(link.fromId, link.toId, {isRootLevel});\n      });\n    });\n\n    pointerEvents.setPaused(true); // let the subgraph to handle the events\n    if (subgraphVisualizer) {\n      // we don't want any animation here. Dispose right away!\n      subgraphVisualizer.dispose();\n      subgraphVisualizer = null;\n    } \n    runSubGraphVisualizer();\n\n    function addNeighbors(node, neighborsSet) {\n      graph.forEachLinkedNode(node, otherNode => {\n        neighborsSet.add(otherNode.id);\n      });\n    }\n\n    function runSubGraphVisualizer() {\n      subgraphVisualizer = createSubgraphVisualizer(subgraph, viewBox, sceneLayerManager, nodeNameToUI)\n      subgraphVisualizer.run();\n    }\n  }\n\n  function dispose() {\n    if (loader) loader.dispose();\n    bus.off('focus-node', focusNode);\n    bus.off('unfocus', unfocus);\n    bus.off('exit-subgraph', exitSubgraphMode);\n\n    pointerEvents.dispose();\n    scene.dispose();\n  }\n\n  function focusNode(nodeName) {\n    // this means they entered something in the search box\n    let ui = lookAtNode(nodeName);\n    if (!ui) return;\n\n    if (subgraphVisualizer) {\n      subgraphVisualizer.dispose(() => {\n        pointerEvents.setPaused(false); // we take care of the events now\n      });\n      subgraphVisualizer = null;\n    }\n\n    pointerEvents.focusUI(ui);\n    scene.renderFrame();\n    if (inputTarget) inputTarget.focus();\n  }\n\n  function unfocus() {\n    // This means they closed the sidebar\n    pointerEvents.clearHighlights();\n\n    scene.renderFrame();\n  }\n\n  function exitSubgraphMode() {\n    if (subgraphVisualizer) {\n      subgraphVisualizer.dispose(() => {\n        pointerEvents.setPaused(false); // take care of the events now\n      });\n      subgraphVisualizer = null;\n      if (inputTarget) inputTarget.focus();\n    }\n  }\n\n  function loadSVG(path) {\n    if (loader) loader.dispose();\n\n    loader = createSVGLoader(path)\n      .on('element-start', handleElementStart)\n      .on('element-end', handleElementEnd)\n      .load();\n  }\n\n  function handleElementStart(element) {\n    // TODO: this would be better done with FSM\n    if (element.tagName === 'svg') {\n      let viewBoxArr = (element.attributes.get('viewBox') || '0 0 1024 1024')\n        .split(' ')\n        .map((x) => Number.parseFloat(x))\n        .filter(finiteNumber);\n\n      if (viewBoxArr.length !== 4) throw new Error('Unknown viewBox definition: ' + element.attributes.get('viewBox'));\n\n      viewBox = {\n        left: viewBoxArr[0],\n        top: viewBoxArr[1],\n        width: viewBoxArr[2],\n        height: viewBoxArr[3],\n      };\n      pointerEvents.setViewBox(viewBox);\n\n      if (!ignoreSVGViewBox) {\n        scene.setViewBox({\n          left: viewBox.left,\n          top: viewBox.top,\n          right: viewBox.left + viewBox.width,\n          bottom: viewBox.top + viewBox.height,\n        });\n      }\n    } else if (element.tagName === 'path') {\n      addBorder(element);\n    } else if (element.tagName === 'circle') {\n      addNode(element);\n    } else {\n      let transform = element.attributes.get('transform');\n      if (transform) currentTransform.pushTransform(transform);\n    }\n  }\n\n  function handleElementEnd(element) {\n    let transform = element.attributes.get('transform');\n    if (transform) currentTransform.popTransform(transform);\n    if (element.tagName === 'text' && element.innerText) {\n      appendTextLabel(element);\n    }\n  }\n\n  function appendTextLabel(el) {\n    let fontSize = getNumericAttribute(el, 'font-size');\n    let alpha = Math.floor(\n      (el.attributes.has('fill-opacity') ? getNumericAttribute(el, 'fill-opacity') : 0.2\n    ) * 0xff);\n    let color = 0x00000000;\n    if (el.attributes.has('fill')) color = hexColor(getElementFillColor(el));\n    color = (color & (0xffffff00)) | alpha;\n    labelsText.addText({\n      x: getNumericAttribute(el, 'x'),\n      y: transformY(getNumericAttribute(el, 'y') - fontSize),\n      color,\n      text: el.innerText,\n      fontSize,\n    })\n\n  }\n\n  function addNode(el) {\n    let x = getNumericAttribute(el, 'cx', 0);\n    let y = transformY(getNumericAttribute(el, 'cy', 0));\n    let r = getNumericAttribute(el, 'r');\n    let nodeName = getTextAttribute(el, 'id');\n    if (nodeName[0] === '_') nodeName = nodeName.substr(1);\n    if (nodeNameToUI.has(nodeName)) {\n      throw new Error('Duplicate node name ' + nodeName);\n    }\n    let componentId = getTextAttribute(el.parent, 'id');\n    let neighbors = nodesByComponent.get(componentId);\n    if (!neighbors) {\n      neighbors = new Set();\n      nodesByComponent.set(componentId, neighbors);\n    }\n    neighbors.add(nodeName);\n\n    let position = currentTransform.transform(x, y);\n    let ui = {\n      componentId,\n      position,\n      color: 0xdcdcdcff,\n      size: r * 2,\n      id: positions.length,\n      name: nodeName,\n    };\n    nodeNameToUI.set(nodeName, ui);\n    positions.push(ui);\n    pointerEvents.addNode(ui);\n    nodes.add(ui);\n\n    text.addText({\n      x: position[0],\n      y: position[1] - r,\n      text: nodeName,\n      limit: 3.14 * r,\n      cx: 0.5,\n    });\n    fuzzySearcher.addWord(nodeName);\n\n    setProgressDebounced(getLoadedSubreddits);\n    scene.renderFrame();\n    if (persistedName && nodeName === persistedName && appState.query === persistedName && !appState.userTypedSomething) {\n      bus.fire('show-subreddit', nodeName);\n    }\n  }\n\n  function getLoadedSubreddits() {\n    return {\n      message: 'Loaded ' + formatNumber(nodeNameToUI.size) + ' subreddits...'\n    };\n  }\n\n  function transformY(y) {\n    return viewBox.height + viewBox.top - y;\n  }\n\n  function addBorder(el) {\n    let id = el.attributes.get('id');\n    // if (id.indexOf('polygon') === 0) return;\n\n    let { points, color } = parseBorder(el);\n    boundariesFill.addPolygon({ polygon: points, color: color });\n    let clusterId = (id && id.substr(1)) || '';\n    clusterColors.set(clusterId, color)\n    complimentaryColor.set(clusterId, getComplimentaryColor(color));\n    scene.renderFrame();\n  }\n\n  function initScene() {\n    inputTarget = document.querySelector('#events-input');\n    let scene = createScene(canvas, { \n      allowPinchRotation: false,\n      inputTarget,\n      near: 10,\n      // maxZoom: 1500000,\n      minZoom: 50,\n      useDeviceOrientation: false\n    });\n\n    scene.setClearColor(0x0f / 255, 0x0f / 255, 0x0f / 255, 0);\n\n    let cameraPosition = appState.getCameraPosition();\n    if (cameraPosition) {\n      // This is a bit fragile, but it works:\n      let position = scene.getDrawContext().view.position;\n      position[0] = cameraPosition[0];\n      position[1] = cameraPosition[1];\n      position[2] = cameraPosition[2];\n      scene.getCameraController().setViewBox();\n      ignoreSVGViewBox = true;\n    } else {\n      let initialSceneSize = 500;\n      scene.setViewBox({\n        left: -initialSceneSize,\n        top: -initialSceneSize,\n        right: initialSceneSize,\n        bottom: initialSceneSize,\n      });\n    }\n    return scene;\n  }\n\n  function parseBorder(el) {\n    let points = getPointsFromPathData(el.attributes.get('d')).map(([x, y]) => {\n      let [x0, y0] = currentTransform.transform(x, transformY(y));\n      return [x0, y0];\n    });\n    let color = hexColor(getElementFillColor(el));\n    return { points, color };\n  }\n}\n\nfunction createTransformParser() {\n  let isDirty = false;\n  let tx = 0,\n    ty = 0;\n  let transformStack = [];\n\n  return {\n    pushTransform,\n    popTransform,\n    transform,\n  };\n\n  function pushTransform(transformStr) {\n    isDirty = true;\n    transformStack.push(parseTransform(transformStr));\n  }\n\n  function popTransform() {\n    if (transformStack.length === 0) throw new Error('Nothing to pop');\n    transformStack.pop();\n    isDirty = true;\n  }\n\n  function parseTransform(str) {\n    let transformNumbers = str.match(/matrix\\((.+)\\)$/i);\n    if (!transformNumbers)\n      throw new Error('Unknown transformation record: ' + str);\n    let coefficients = transformNumbers[1]\n      .split(',')\n      .map((x) => Number.parseFloat(x))\n      .filter(finiteNumber);\n    if (coefficients.length !== 6)\n      throw new Error('Only matrix(a,b,c,d,e,f) is supported at the moment');\n    return coefficients;\n  }\n\n  function transform(x, y) {\n    updateTransform();\n    return [x + tx, y - ty, 0];\n  }\n\n  function updateTransform() {\n    if (!isDirty) return;\n\n    // TODO: this should be real math\n    tx = 0;\n    ty = 0;\n    transformStack.forEach((record) => {\n      tx += record[4];\n      ty += record[5];\n    });\n    isDirty = false;\n  }\n}\n\nfunction finiteNumber(x) {\n  return Number.isFinite(x);\n}\n\nfunction getNumericAttribute(el, name, defaultValue) {\n  let value = Number.parseFloat(el.attributes.get(name));\n  if (!Number.isFinite(value)) {\n    if (defaultValue !== undefined) return defaultValue;\n    throw new Error('Element ' + el.tagName + ' does not have a finite numeric attribute ' + name);\n  }\n  return value;\n}\n\nfunction getTextAttribute(el, name) {\n  return el.attributes.get(name) || '';\n}\n\nfunction hexColor(rgbArray) {\n  return (rgbArray[0] << 24) | (rgbArray[1] << 16) | (rgbArray[2] << 8) | 0xff;\n}\n\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_vm._v(\" \"+_vm._s(_vm.data.data)+\" \")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Based on https://github.com/ElemeFE/element/blob/dev/src/utils/clickoutside.js\n// The MIT License (MIT), Copyright (c) 2016 ElemeFE\nconst nodeList = [];\nconst ctx = '@@clickoutsideContext';\n\nlet startClick;\nlet seed = 0;\n\ndocument.addEventListener('mousedown', e => (startClick = e));\ndocument.addEventListener('mouseup', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n});\n\n// Also hide when tapped outside.\ndocument.addEventListener('touchstart', e => {\n  startClick = e;\n});\ndocument.addEventListener('touchend', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n});\n\nfunction createDocumentHandler(el, binding, vnode) {\n\n  return function(mouseup = {}, mousedown = {}) {\n    if (!vnode || !vnode.context ||\n      !mouseup.target || !mousedown.target ||\n      el.contains(mouseup.target) ||\n      el.contains(mousedown.target) ||\n      el === mouseup.target ||\n      (vnode.context.popperElm &&\n      (vnode.context.popperElm.contains(mouseup.target) ||\n      vnode.context.popperElm.contains(mousedown.target)))) return;\n\n    const methodName = el[ctx].methodName;\n    if (binding.expression && methodName && vnode.context[methodName]) {\n      vnode.context[methodName]();\n    } else {\n      el[ctx].bindingFn && el[ctx].bindingFn();\n    }\n  };\n}\n\nexport default {\n  bind(el, binding, vnode) {\n    nodeList.push(el);\n    const id = seed++;\n    el[ctx] = {\n      id,\n      documentHandler: createDocumentHandler(el, binding, vnode),\n      methodName: binding.expression,\n      bindingFn: binding.value\n    };\n  },\n\n  update(el, binding, vnode) {\n    el[ctx].documentHandler = createDocumentHandler(el, binding, vnode);\n    el[ctx].methodName = binding.expression;\n    el[ctx].bindingFn = binding.value;\n  },\n\n  unbind(el) {\n    let len = nodeList.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodeList[i][ctx].id === el[ctx].id) {\n        nodeList.splice(i, 1);\n        break;\n      }\n    }\n    delete el[ctx];\n  }\n};","\n<template>\n<div>\n  {{data.data}}\n</div>\n</template>\n<script>\n\nexport default {\n  props: ['data'],\n  data() {\n    return {}\n  },\n  methods: {\n  }\n}\n</script>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Tooltip.vue?vue&type=template&id=552f3579\"\nimport script from \"./Tooltip.vue?vue&type=script&lang=js\"\nexport * from \"./Tooltip.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.hideSuggestions),expression:\"hideSuggestions\"}],staticClass:\"ak-typeahead\"},[_c('a',{staticClass:\"menu-opener\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.menuClicked.apply(null, arguments)}}},[_c('svg',{staticClass:\"feather feather-info\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"12\",\"y1\":\"16\",\"x2\":\"12\",\"y2\":\"12\"}}),_c('line',{attrs:{\"x1\":\"12\",\"y1\":\"8\",\"x2\":\"12.01\",\"y2\":\"8\"}})])]),_c('input',{ref:\"input\",attrs:{\"autofocus\":\"\",\"type\":\"text\",\"autocomplete\":\"off\",\"autocorrect\":\"off\",\"autocapitalize\":\"off\",\"spellcheck\":\"false\",\"placeholder\":_vm.placeholder},domProps:{\"value\":_vm.currentQuery},on:{\"input\":_vm.handleInput,\"keydown\":_vm.cycleTheList}}),(_vm.currentQuery || _vm.showClearButton)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.clearSearch.apply(null, arguments)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])]):_vm._e(),(_vm.showSuggestions)?_c('ul',{staticClass:\"suggestions\"},_vm._l((_vm.suggestions),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",class:{selected: suggestion.selected},attrs:{\"href\":\"#\"},domProps:{\"innerHTML\":_vm._s(suggestion.html)},on:{\"click\":function($event){$event.preventDefault();return _vm.pickSuggestion(suggestion)}}})])}),0):_vm._e(),(_vm.showLoading)?_c('ul',{staticClass:\"suggestions\"},[_c('li',{staticClass:\"searching\"},[(!_vm.loadingError)?_c('span',[_vm._v(\"Searching...\")]):_vm._e(),(_vm.loadingError)?_c('div',{staticClass:\"loading-error\"},[_c('div',[_vm._v(\"Failed to get reddit completions:\")]),_c('pre',[_vm._v(_vm._s(_vm.loadingError))])]):_vm._e()])]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class='ak-typeahead' v-click-outside='hideSuggestions'>\n    <a href=\"#\" class='menu-opener' @click.prevent='menuClicked'>\n      <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-info\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>\n  </a>\n    <input\n      ref='input' autofocus\n      type='text'\n      autocomplete='off'\n      autocorrect='off'\n      autocapitalize='off'\n      spellcheck='false'\n      :value='currentQuery' \n      :placeholder='placeholder'\n      @input='handleInput'\n      @keydown=\"cycleTheList\"\n    >\n    <a\n      type='submit'\n      class='search-submit'\n      href='#'\n      @click.prevent='clearSearch'\n      v-if='currentQuery || showClearButton'\n    >\n<!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\">\n  <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n    <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line>\n    <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>\n  </svg>\n</a>\n    <ul v-if=\"showSuggestions\" class=\"suggestions\">\n      <li v-for=\"(suggestion, index) in suggestions\" :key=\"index\">\n        <a\n          @click.prevent=\"pickSuggestion(suggestion)\"\n          class=\"suggestion\"\n          :class=\"{selected: suggestion.selected}\"\n          href=\"#\"\n          v-html=\"suggestion.html\"\n        ></a>\n      </li>\n    </ul>\n\n    <ul v-if=\"showLoading\" class=\"suggestions\">\n      <li class=\"searching\">\n        <span v-if=\"!loadingError\">Searching...</span>\n        <div v-if=\"loadingError\" class=\"loading-error\">\n          <div>Failed to get reddit completions:</div>\n          <pre>{{loadingError}}</pre>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport ClickOutside from '../lib/clickOutside.js'\n\nexport default {\n  directives: { ClickOutside },\n  props: {\n    placeholder: {\n      default: \"Type here\"\n    },\n    showClearButton: {\n      default: false\n    },\n    query: {\n      default: \"\"\n    },\n    delay: {\n      default: 80\n    }\n  },\n  data() {\n    return {\n      currentSelected: -1,\n      showSuggestions: false,\n      showLoading: false,\n      loadingError: null,\n      suggestions: [],\n      currentQuery: this.query\n    };\n  },\n  watch: {\n    query(newQuery) {\n      this.currentQuery = newQuery;\n    }\n  },\n  methods: {\n    refresh() {\n      if (this.showSuggestions) this.getSuggestionsInternal();\n    },\n\n    menuClicked() {\n      this.$emit('menuClicked');\n    },\n\n    hideSuggestions() {\n      this.showSuggestions = false;\n      this.showLoading = false;\n      this.pendingKeyToShow = true;\n    },\n\n    showIfNeeded(visible) {\n      // we need to wait until next key press before we can show suggestion.\n      // This avoids race conditions between search results and form submission\n      if (!this.pendingKeyToShow) this.showSuggestions = visible;\n    },\n\n    focus() {\n      this.$refs.input.focus();\n    },\n\n    pickSuggestion(suggestion) {\n      let composedQuery = this.currentQuery;\n      if (composedQuery.indexOf('+') > -1) {\n        let parts = composedQuery.split('+');\n        if (parts.length > 1) {\n          parts.pop();\n          parts.push(suggestion.text);\n          this.currentQuery = parts.map(part => part.trim()).join('+');\n        } else {\n          this.currentQuery = suggestion.text;\n        }\n      } else {\n        this.currentQuery = suggestion.text;\n      }\n      this.hideSuggestions();\n      this.$emit(\"selected\", this.currentQuery);\n    },\n\n    clearSearch() {\n      let payload = {shouldProceed: true};\n      this.$emit('beforeClear', payload);\n      if (!payload.shouldProceed) return;\n\n      this.currentQuery = '';\n      this.getSuggestionsInternal();\n      // this.focus();\n      this.$emit(\"cleared\");\n    },\n\n    handleInput(event) {\n      this.currentQuery = event.target.value;\n      this.$emit('inputChanged');\n      this.getSuggestionsInternal();\n    },\n\n    getSuggestionsInternal() {\n      var self = this;\n      if (self.previous) {\n        window.clearTimeout(self.previous);\n        self.previous = null;\n      }\n      if (!self.currentQuery) {\n        this.showSuggestions = false;\n        return;\n      }\n\n      self.previous = window.setTimeout(function() {\n        let parts = self.currentQuery.split('+')\n        let q = parts[parts.length - 1].trim();\n        var p = window.fuzzySearcher.find(q);\n\n        if (Array.isArray(p)) {\n          self.suggestions = p.map(x => ({\n            selected: false,\n            text: x.text,\n            html: x.html\n          }));\n          self.currentSelected = -1;\n          self.showIfNeeded(p && p.length > 0);\n        } else if (p) {\n          self.loadingError = null;\n          // self.showLoading = true;\n          p.then(\n            function(suggestions) {\n              self.showLoading = false;\n              suggestions = suggestions || [];\n              self.suggestions = suggestions.map(x => ({\n                selected: false,\n                text: x.text,\n                html: x.html\n              }));\n              self.currentSelected = -1;\n              self.showIfNeeded(suggestions && suggestions.length > 0);\n            },\n            function(err) {\n              self.loadingError = err;\n            }\n          );\n        } else {\n          throw new Error(\"Could not parse suggestions response\");\n        }\n      }, self.delay);\n    },\n\n    cycleTheList(e) {\n      var items = this.suggestions;\n      var currentSelected = this.currentSelected;\n      // Any key is alright for the suggestions\n      this.pendingKeyToShow = false;\n\n      let dx;\n      if (e.which === 38) {\n        // UP\n        dx = -1;\n      } else if (e.which === 40) {\n        // down\n        dx = 1;\n      } else if (e.which === 13) {\n        // Enter === accept\n        if (items[currentSelected]) {\n          this.pickSuggestion(items[currentSelected]);\n        } else {\n          this.pickSuggestion({ text: this.currentQuery });\n        }\n        e.preventDefault();\n        return;\n      } else if (e.which === 27) {\n        // Esc === close\n        this.hideSuggestions();\n      }\n\n      if (!dx || items.length === 0) return;\n\n      e.preventDefault();\n\n      if (currentSelected >= 0) {\n        this.suggestions[currentSelected].selected = false;\n      }\n      currentSelected += dx;\n      if (currentSelected < 0) currentSelected = items.length - 1;\n      if (currentSelected >= items.length) currentSelected = 0;\n\n      this.suggestions[currentSelected].selected = true;\n      this.currentSelected = currentSelected;\n    }\n  }\n};\n</script>\n\n<style lang='stylus'>\n@import '../vars.styl';\n\n.ak-typeahead {\n  height: 100%;\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n\n  input::-ms-clear {\n    display: none;\n  }\n}\n\n  .menu-opener {\n    display: flex;\n    align-items: center;\n    padding: 0 8px;\n    background: background-color;\n    &:hover, &:focus {\n      color: primary-color;\n      background: highlight-color;\n    }\n  }\n\n.search-submit {\n  color: border-hover;\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  width: 48px;\n  justify-content: center;\n  outline: none;\n\n  &:hover, &:focus {\n    color: primary-color;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block;\n  width: 100%;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  text-decoration: none;\n  font-weight: bold;\n  color: primary-text;\n\n  b {\n    font-weight: normal;\n  }\n}\n\n.suggestion:hover, .suggestion.selected {\n  background-color: highlight-color;\n  color: primary-color;\n}\n\n.suggestions {\n  position: absolute;\n  top: 48px;\n  width: 100%;\n  padding: 0;\n  background: white;\n  list-style-type: none;\n  margin: 0;\n  border-top: 1px solid $border-color;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\n  .searching {\n    margin: 8px;\n  }\n\n  .loading-error {\n    pre {\n      color: orangered;\n      overflow-x: auto;\n      padding-bottom: 14px;\n    }\n  }\n}\n\ninput[type='text'] {\n  height: 100%;\n  width: 100%;\n  padding-left: 10px;\n  font-size: 18px;\n  border: 0;\n  border-radius: 0;\n}\n\ninput:focus {\n  outline: none;\n}\n\ninput::placeholder {\n  color: $hint-text;\n}\n\n@media (max-width: small-screen-width) {\n  .suggestion {\n    height: 42px;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Typeahead.vue?vue&type=template&id=6bfb7a94\"\nimport script from \"./Typeahead.vue?vue&type=script&lang=js\"\nexport * from \"./Typeahead.vue?vue&type=script&lang=js\"\nimport style0 from \"./Typeahead.vue?vue&type=style&index=0&id=6bfb7a94&prod&lang=stylus\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"sidebar\"},[_c('div',{staticClass:\"row\"},[_c('h3',[_vm._v(\"Map of Reddit\")]),_c('a',{staticClass:\"close-btn\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onClose.apply(null, arguments)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])])]),_vm._m(0)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container\"},[_c('p',[_vm._v(\" Each dot is a subreddit. Two dots within the same cluster are usually close to each other if multiple users frequently leave comments on both subreddits. \")]),_c('p',[_vm._v(\" If you find something missing, please feel free to \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit\",\"target\":\"_blank\"}},[_vm._v(\"edit the map\")]),_vm._v(\". \")]),_c('p',[_vm._v(\" I spent last couple years developing this website as a hobby project. If you enjoy this work please support it \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.paypal.com/paypalme/anvakos/5\"}},[_vm._v(\"on Paypal\")]),_vm._v(\", \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"Patreon\")]),_vm._v(\" or \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/sponsors/anvaka\"}},[_vm._v(\"GitHub\")]),_vm._v(\" and I promise to not disappoint you with new features :). \")]),_c('p',[_vm._v(\" Please follow me on Twitter to stay in touch: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"https://twitter.com/anvaka\")]),_vm._v(\". \")]),_c('p',[_vm._v(\" Thank you for your interest and support! \")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"sidebar\">\n    <div class='row'>\n      <h3>Map of Reddit</h3>\n      <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n        <a href='#' @click.prevent='onClose' class='close-btn'>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>\n        </a>\n    </div>\n\n    <div class=\"container\">\n      <p>\n        Each dot is a subreddit. Two dots within the same cluster are \n        usually close to each other if multiple users frequently leave comments on both subreddits.\n      </p>\n      <p>\n        If you find something missing, please feel free to <a href='https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit' target='_blank' class='accent'>edit the map</a>.\n      </p>\n      <p>\n        I spent last couple years developing this website as a hobby project. If you enjoy\n        this work please support it <a href=\"https://www.paypal.com/paypalme/anvakos/5\" class=\"accent\">on Paypal</a>, <a href=\"https://www.patreon.com/anvaka\" class='accent'>Patreon</a> or\n        <a href=\"https://github.com/sponsors/anvaka\" class='accent'>GitHub</a> and I promise to not disappoint you\n        with new features :).\n      </p>\n      <p>\n      Please follow me on Twitter  to stay in touch: <a href='https://twitter.com/anvaka' class='accent'>https://twitter.com/anvaka</a>.\n      </p>\n      <p>\n        Thank you for your interest and support!\n      </p>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  mounted() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  },\n  methods: {\n    onClose() {\n      this.$emit('close');\n    },\n    handleKeyDown(e) {\n      if (e.which === 27 /* ESC */) {\n        this.onClose();\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Sidebar.vue?vue&type=template&id=b8cc0658\"\nimport script from \"./Sidebar.vue?vue&type=script&lang=js\"\nexport * from \"./Sidebar.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('h3',[_vm._v(\"Improve this map\")]),_c('a',{staticClass:\"close-btn\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onClose.apply(null, arguments)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])]),_c('p',[_vm._v(\"The entire website is open source. You can contribute in multiple ways:\")]),_vm._m(0),_vm._v(\" Thank you for your support! \"),_c('br'),_vm._v(\" ♥️ Anvaka \")])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('ul',[_c('li',[_vm._v(\" Discuss this product on our own subreddit: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.reddit.com/r/MofR/\"}},[_vm._v(\"/r/MofR\")])]),_c('li',[_vm._v(\"Support this work \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"on Patreon\")]),_vm._v(\" or \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/sponsors/anvaka\"}},[_vm._v(\"GitHub\")]),_vm._v(\". There is a lot of things I'd love to improve about this project, but without your support I wouldn't know if I'm moving in the right direction. \")]),_c('li',[_vm._v(\" Add new subreddits or update positions of existing ones if you found an issue. Please follow instructions \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit\",\"target\":\"_blank\"}},[_vm._v(\"here\")]),_vm._v(\". \")]),_c('li',[_vm._v(\"If you found a rendering bug - consider reporting it or fixing it \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit\",\"target\":\"_blank\"}},[_vm._v(\"here\")]),_vm._v(\". \")]),_c('li',[_vm._v(\" Share your suggestions and follow me on Twitter. My direct messages are open: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"https://twitter.com/anvaka\")])])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <h3>Improve this map</h3>\n    <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n    <a href='#' @click.prevent='onClose' class='close-btn'>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>\n    </a>\n    <p>The entire website is open source. You can contribute in multiple ways:</p>\n    <ul>\n      <li>\n        Discuss this product on our own subreddit: <a href='https://www.reddit.com/r/MofR/' class='accent'>/r/MofR</a>\n      </li>\n      <li>Support this work <a href=\"https://www.patreon.com/anvaka\" class='accent'>on Patreon</a> or\n      <a href=\"https://github.com/sponsors/anvaka\" class='accent'>GitHub</a>. There is a lot of things\n      I'd love to improve about this project, but without your support I wouldn't know if I'm moving\n      in the right direction.\n      </li>\n      <li>\n        Add new subreddits or update positions of existing ones if you found an issue. Please \n        follow instructions  <a href='https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit'\n        class='accent' target='_blank'>here</a>.\n      </li>\n      <li>If you found a rendering bug - consider reporting it or fixing it \n        <a href='https://github.com/anvaka/map-of-reddit' class='accent' target='_blank'>here</a>.\n      </li>\n      <li>\n        Share your suggestions and follow me on Twitter. My direct messages are open: \n<a href='https://twitter.com/anvaka' class='accent'>https://twitter.com/anvaka</a>\n      </li>\n    </ul>\n    Thank you for your support! <br/>\n    ♥️ Anvaka\n  </div>\n</template>\n\n<script>\nexport default {\n  mounted() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  },\n  methods: {\n    onClose() {\n      this.$emit('close');\n    },\n    handleKeyDown(e) {\n      if (e.which === 27 /* ESC */) {\n        this.onClose();\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImproveWindow.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImproveWindow.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ImproveWindow.vue?vue&type=template&id=6f529b0a\"\nimport script from \"./ImproveWindow.vue?vue&type=script&lang=js\"\nexport * from \"./ImproveWindow.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('a',{staticClass:\"small-preview-container\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showFullPreview.apply(null, arguments)}}},[_c('div',{staticClass:\"header\"},[_c('span',[_vm._v(\"r/\"+_vm._s(_vm.name))]),(_vm.details)?_c('span',{staticClass:\"subscribers-count\"},[_vm._v(_vm._s(_vm.details.subscribers)+\" members · \"+_vm._s(_vm.details.active)+\" active\")]):_vm._e()]),(_vm.loading)?_c('loading-icon'):_vm._e(),(_vm.details && _vm.details.image)?_c('img',{staticClass:\"community-icon\",attrs:{\"src\":_vm.details.image.icon}}):_vm._e(),(_vm.details)?_c('div',{staticClass:\"info\"},[_vm._v(_vm._s(_vm.details.description))]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('svg',{staticClass:\"loader\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 32 32\",\"width\":\"28\",\"height\":\"28\",\"fill\":\"white\"}},[_c('path',{attrs:{\"opacity\":\".25\",\"d\":\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"}}),_c('path',{attrs:{\"d\":\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"}},[_c('animateTransform',{attrs:{\"attributeName\":\"transform\",\"type\":\"rotate\",\"from\":\"0 16 16\",\"to\":\"360 16 16\",\"dur\":\"0.8s\",\"repeatCount\":\"indefinite\"}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./LoadingIcon.vue?vue&type=template&id=83262da8\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <a href='#' @click.prevent='showFullPreview' class='small-preview-container'>\n    <div class='header'>\n      <span>r/{{name}}</span>\n      <span v-if='details' class='subscribers-count'>{{details.subscribers}} members · {{details.active}} active</span>\n    </div>\n    <loading-icon v-if='loading'></loading-icon>\n    <img v-if='details && details.image' :src='details.image.icon' class='community-icon'>\n    <div class='info' v-if='details'>{{details.description}}</div>\n    <!-- <div class='thumbnails' v-if='details && details.image'>\n      <img v-if='details.image.banner' :src='details.image.banner' class='banner'>\n      <img :src='details.image.icon' class='community-icon'>\n    </div> -->\n  </a>\n</template>\n<script>\nimport bus from './lib/bus';\nimport LoadingIcon from './LoadingIcon'\nimport {formatNumber} from './lib/utils';\n\nexport default {\n  name: 'SmallPreview',\n  props: ['name'],\n  components: {\n    LoadingIcon\n  },\n  data() {\n    return {\n      loading: true,\n      details: null\n    }\n  },\n  watch: {\n    name() {\n      this.getSubredditInfo();\n    }\n  },\n  mounted() {\n    this.getSubredditInfo();\n  },\n  methods: {\n    showFullPreview() {\n      bus.fire('show-subreddit', this.name, true);\n    },\n    getSubredditInfo() {\n      let fetchedName = this.name;\n      this.details = null;\n      this.loading = true;\n      fetch('https://www.reddit.com/r/' + fetchedName + '/about.json', {mode: 'cors'})\n        .then(x => x.json())\n        .then(x => {\n          if (this.name !== fetchedName) return;\n          let data = x.data;\n          let description = data.public_description;\n          let displayName = data.display_name_prefixed;\n          let subscribers = formatNumber(data.subscribers);\n          let active = formatNumber(data.accounts_active);\n          this.loading = false;\n          let image = null;\n          let icon = data.icon_img || data.community_icon;\n          if (icon) {\n            let banner = data.banner_img || data.banner_background_image;\n            image = {\n              icon: icon.split('?')[0],\n              banner: banner ? banner.split('?')[0] : null\n            }\n          }\n          if (data.over18 && !window.ageConfirmed) {\n            image = null;\n          }\n          this.details = {\n            description, displayName, subscribers, active, image\n          }\n        })\n    }\n  }\n};\n</script>\n<style lang=\"stylus\">\ntext-color = #eee;\n.loader {\n  margin: 8px;\n}\n.header {\n  font-size: 16px;\n}\n.small-preview-container {\n  padding: 4px 8px;\n  font-size: 12px;\n  color: text-color;\n  a {\n    color: text-color;\n  }\n}\n.info {\n  margin-top: 4px;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n.subscribers-count {\n  color: #999999;\n  float: right;\n  display: inline-block;\n  font-size: 12px;\n}\n.community-icon {\n  width: 32px;\n  border-radius: 100%;\n  margin: 8px;\n  float: left;\n}\n.banner {\n  // height: 48px;\n  width: 100%;\n  position: absolute;\n  top: 0px;\n}\n.thumbnails {\n  overflow: hidden;\n  position: absolute;\n  bottom: 84px;\n  width: 100%;\n  height: 48px;\n  background: orange;\n  left: 0;\n}\n</style>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SmallPreview.vue?vue&type=template&id=7b1a6d47\"\nimport script from \"./SmallPreview.vue?vue&type=script&lang=js\"\nexport * from \"./SmallPreview.vue?vue&type=script&lang=js\"\nimport style0 from \"./SmallPreview.vue?vue&type=style&index=0&id=7b1a6d47&prod&lang=stylus\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default function createFirstInteractionListener(callback) {\n  window.addEventListener('mousedown', handleFirstEvent, true);\n  window.addEventListener('wheel', handleFirstEvent, true);\n  window.addEventListener('touchstart', handleFirstEvent, true);\n  window.addEventListener('keydown', handleFirstEvent, true);\n\n  let called = false;\n\n  return dispose;\n\n  function handleFirstEvent() {\n    if (called) return;\n    called = true;\n    callback();\n  }\n\n  function dispose() {\n    window.removeEventListener('mousedown', handleFirstEvent, true);\n    window.removeEventListener('wheel', handleFirstEvent, true);\n    window.removeEventListener('touchstart', handleFirstEvent, true);\n    window.removeEventListener('keydown', handleFirstEvent, true);\n  }\n}","<template>\n  <div id=\"app\">\n    <div v-if='!isWebGLEnabled'>\n      <div class='absolute no-webgl'>\n        <h4>WebGL is not enabled :(</h4>\n        <p>This website needs <a href='https://en.wikipedia.org/wiki/WebGL' class='accent'>WebGL</a> to render a map of reddit.\n        </p> <p>\n        You can try another browser. If the problem persists - very likely your video card isn't supported.\n        </p>\n      </div>\n    </div>\n    <div v-if='isWebGLEnabled'>\n    <transition name='fade'>\n      <div class='progress' v-if='progressMessage'>{{progressMessage}}</div>\n    </transition>\n    <transition name='fade'>\n      <div class='progress subgraph' v-if='subgraphName && !isStreetViewMode'>\n        Only <a href='#' class='accent' @click.prevent='onSubgraphRootClick'>/r/{{subgraphName}}</a> related subreddits are shown.\n        <a href='#' class='accent' @click.prevent='onExitSubgraph'>view all</a>\n      </div>\n    </transition>\n    <transition name='fade'>\n      <div class='progress subgraph' v-if='isStreetViewMode && !isStreetViewInProgress'>\n        <a href='#' class='accent' @click.prevent='onExitStreetView'>exit street view</a>\n      </div>\n    </transition>\n    <subreddit v-if=\"subreddit\" :name=\"subreddit\" :sort=\"defaultSort\" :time=\"defaultTime\" class=\"preview\" @declineAge='onDeclineAge'>\n      <template slot='after-title'>\n        <div>\n          <a href='#' class='subreddit-action' @click.prevent='showRelated' v-if='graphLoaded'>Show related</a>\n          <a href='#' class='subreddit-action' @click.prevent='showStreetView' v-if='streetViewEnabled && graphLoaded && !isSubgraphLayoutInProgress'>Street view</a>\n          <div v-if='graphLoaded'>\n            <input type=\"checkbox\" id=\"checkbox\" v-model=\"multiView\">\n            <label for=\"checkbox\">Multireddit view from neighbors</label>\n          </div>\n          <span v-if='!graphLoaded' class='subreddit-action'>the map is still loading...</span>\n        </div>\n      </template>\n    </subreddit>\n    <form @submit.prevent=\"onSubmit\" class=\"search-box\">\n      <typeahead\n        placeholder=\"Find subreddit\"\n        @menuClicked='sidebarVisible = true'\n        @selected='findSubreddit'\n        @beforeClear='closeSubredditOnSmallScreen'\n        @cleared='closeSubredditViewer'\n        @inputChanged='onTypeAheadInput'\n        :showClearButton=\"subreddit\"\n        :query=\"appState.query\"\n      ></typeahead>\n    </form>\n\n    <div class=\"support\" :class=\"{subgraph: subgraphName && !isStreetViewMode, street: isStreetViewMode}\" v-if=\"graphLoaded && progressMessage === null\">\n      Enjoying this map? <br>\n      <a href='https://www.paypal.com/paypalme/anvakos/5' target=\"_blank\"  class='accent'>Support the author</a>\n    </div>\n    <a href='#' @click.prevent='onImproveClick' class='accent improve'>Improve this map</a>\n    <transition name='slide-bottom'>\n      <small-preview v-if=\"smallPreview\" :name=\"smallPreview\" class=\"small-preview\"></small-preview>\n    </transition>\n\n    <transition name='slide-top'>\n      <improve-window v-if='improveVisible' @close='improveVisible = false' class='improve-window'></improve-window>\n    </transition>\n\n    <tooltip\n      v-if=\"tooltip\"\n      :style=\"{\n      left: tooltip.x + 'px',\n      top: tooltip.y + 'px'\n    }\"\n      :data=\"tooltip\"\n      class=\"tooltip\"\n    ></tooltip>\n\n    <transition name='fade'>\n      <div class='backdrop' v-if='sidebarVisible || improveVisible' @click=\"onBackdropClick\"></div>\n    </transition>\n    <transition name='slide-left'>\n      <sidebar v-if=\"sidebarVisible\" @close='sidebarVisible = false'></sidebar>\n    </transition>\n    </div>\n  </div>\n</template>\n\n<script>\nimport \"vuereddit/dist/vuereddit.css\";\n\nimport Vue from 'vue';\nimport createStreamingSVGRenderer from './lib/createStreamingSVGRenderer';\nimport Tooltip from \"./Tooltip\";\nimport Typeahead from \"./components/Typeahead\";\nimport Sidebar from \"./components/Sidebar\";\nimport ImproveWindow from \"./components/ImproveWindow\";\nimport Subreddit from \"vuereddit\";\nimport SmallPreview from \"./SmallPreview\";\nimport appState from \"./appState.js\";\nimport createFirstInteractionListener from './lib/createFirstInteractionListener';\nimport {isWebGLEnabled} from 'w-gl';\n\nimport bus from \"./lib/bus\";\n\nlet Instance = Vue.extend(Subreddit);\nlet nameToInstance = new Map();\n\nexport default {\n  components: {\n    Tooltip,\n    Typeahead,\n    Subreddit,\n    Sidebar,\n    ImproveWindow,\n    SmallPreview,\n  },\n  name: \"app\",\n  watch: {\n    multiView(newValue) {\n      let from = getFirstSubreddit(this.subreddit);\n      let newQuery;\n\n      if (newValue) {\n        let all = this.scene.getNeighbors(from);\n        all.unshift(from);\n        newQuery = all.join('+');\n      } else {\n        newQuery = from;\n      }\n      this.showSubreddit(newQuery)\n    }\n  },\n  methods: {\n    showRelated() {\n      this.scene.showRelated(this.subreddit);\n      this.isSubgraphLayoutInProgress = true;\n      if (isSmallScreen()) {\n        // move panel to the bottom\n        this.smallPreview = this.subreddit;\n        this.subreddit = null;\n      }\n    },\n    showStreetView() {\n      this.scene.showStreetView(this.subreddit);\n      this.subreddit = null;\n      this.tooltip = null;\n      this.isStreetViewMode = true;\n      this.isStreetViewInProgress = true;\n    },\n    onExitStreetView() {\n      this.isStreetViewInProgress = false;\n      this.scene.exitStreetView();\n      this.isStreetViewMode = false;\n    },\n    findSubreddit(q) {\n      appState.query = q;\n      this.onSubmit();\n    },\n    closeSubredditOnSmallScreen(payload) {\n      appState.userTypedSomething = true;\n      if (isSmallScreen() && this.subreddit) {\n        // First time - just close the subreddit, second time - clear all\n        payload.shouldProceed = false;\n        this.subreddit = null;\n        this.scene.focus();\n      } \n    },\n    onTypeAheadInput() {\n      this.typeaheadChanged = true;\n      appState.userTypedSomething = true;\n    },\n    onDeclineAge(e) {\n      e.preventDefault();\n      this.closeSubredditViewer();\n    },\n    onBackdropClick() {\n      this.sidebarVisible = false;\n      this.improveVisible = false;\n    },\n    onImproveClick() {\n      this.improveVisible = true;\n    },\n    closeSubredditViewer() {\n      this.subreddit = null;\n      this.smallPreview = null;\n      appState.query = '';\n      appState.saveQuery(appState.query);\n      bus.fire('unfocus');\n    },\n    showTooltip(e) {\n      if (e) {\n        this.tooltip = e;\n      } else {\n        this.tooltip = null;\n      }\n    },\n    onSubmit() {\n      let originalQuery = appState.query;\n      bus.fire('focus-node', getFirstSubreddit(originalQuery));\n      if (originalQuery !== appState.query) {\n        // This is due to 'show-subreddit' event floating from 'focus-node'\n        // in the scene renderer. Insist that we keep the original input:\n        appState.saveQuery(originalQuery);\n        if (originalQuery && originalQuery.indexOf('+') > -1) {\n          this.subreddit = originalQuery;\n        }\n      }\n      this.subgraphName = null;\n    },\n    onSubgraphRootClick() {\n      bus.fire('subgraph-focus-node', this.subgraphName);\n    },\n    onExitSubgraph() {\n      bus.fire('exit-subgraph');\n      this.subgraphName = null;\n      this.isSubgraphLayoutInProgress = false;\n    },\n    showSubreddit(subreddit, forceFullView) {\n      if (subreddit !== this.subreddit) {\n        this.multiView = subreddit && subreddit.indexOf('+') > -1;\n      }\n      if (!this.scene.isStreetViewMode()) {\n        if (isSmallScreen() && !forceFullView) {\n          this.smallPreview = subreddit;\n        } else {\n          this.smallPreview = null;\n          this.subreddit = subreddit;\n        }\n      }\n      appState.query = subreddit;\n      this.tooltip = null;\n      appState.saveQuery(appState.query);\n    },\n\n    setProgress(progress) {\n      if (progress && progress.mapLoaded) {\n        // last message!\n        if (!this.typeaheadChanged) {\n          this.progressMessage = progress.error ? 'Something is likely not right...' : 'Map is ready to use. Please enjoy';\n        }\n        this.graphLoaded = true;\n        this.disposeFirstListener = createFirstInteractionListener(() => {\n          setTimeout(() => this.progressMessage = null, 3000);\n        });\n      } else if (progress && progress.subgraphDone) {\n        this.progressMessage = null;\n        this.subgraphName = progress.subgraphName;\n        this.isSubgraphLayoutInProgress = false;\n      }  else if (progress && progress.streetViewDone) {\n        this.progressMessage = null;\n        this.isStreetViewInProgress = false;\n      } else if (progress) {\n        this.progressMessage = progress.message;\n        this.subgraphVisualized = null;\n      } \n    },\n    appendDom(e) {\n      // TODO: Consider window.requestIdleCallback?\n      let oldInstance = nameToInstance.get(e.name);\n      if (oldInstance) {\n        oldInstance.$destroy();\n      }\n      let div = document.createElement('div');\n      let viewer = new Instance({propsData: { \n        name: e.name,\n        showFirst: 5,\n        sort: this.defaultSort || 'hot',\n        time: this.defaultTime || 'day'\n      }});\n      viewer.$on('sortChanged', (newSort) => this.defaultSort = newSort);\n      viewer.$on('timeChanged', (newTime) => {\n        this.defaultTime = newTime;\n      });\n      e.dom.appendChild(div);\n      let instance = viewer.$mount(div);\n      nameToInstance.set(e.name, instance)\n    },\n    removeDom(e) {\n      let oldInstance = nameToInstance.get(e.name);\n      if (oldInstance) {\n        oldInstance.$destroy();\n        nameToInstance.delete(e.name);\n      }\n    }\n  },\n  data() {\n    return {\n      improveVisible: false,\n      isWebGLEnabled: false,\n      isStreetViewMode: false,\n      isSubgraphLayoutInProgress: false,\n      isStreetViewInProgress: false,\n      typeaheadChanged: false,\n      tooltip: null,\n      subgraphName: null,\n      subreddit: null,\n      scene: null,\n      smallPreview: null,\n      sidebarVisible: false,\n      progressMessage: '',\n      graphLoaded: false,\n      multiView: false,\n      streetViewEnabled: appState.getQueryState().get('sv') !== false,\n      defaultSort: 'hot',\n      defaultTime: 'day',\n      appState,\n    };\n  },\n  mounted() {\n    const canvas = document.getElementById(\"cnv\");\n    nameToInstance = new Map();\n    this.isWebGLEnabled = isWebGLEnabled(canvas);\n    if (!this.isWebGLEnabled) return;\n\n    let svgRenderer = createStreamingSVGRenderer(canvas);\n    window.getGraph = svgRenderer.getGraph;\n    let path = appState.getFilePath();\n    svgRenderer.loadSVG(path);\n    this.scene = svgRenderer;\n\n    bus.on('show-tooltip', this.showTooltip);\n    bus.on('show-subreddit', this.showSubreddit);\n    bus.on('progress', this.setProgress);\n    bus.on('append-dom', this.appendDom);\n    bus.on('remove-dom', this.removeDom);\n  },\n\n  beforeDestroy() {\n    if (this.scene) {\n      this.scene.dispose();\n    }\n    if (this.disposeFirstListener) {\n      this.disposeFirstListener();\n    }\n    bus.off('show-tooltip', this.showTooltip);\n    bus.off('show-subreddit', this.showSubreddit);\n    bus.off('progress', this.setProgress);\n    bus.off('append-dom', this.appendDom);\n    bus.off('remove-dom', this.removeDom);\n  }\n};\n\nfunction isSmallScreen() {\n  return window.innerWidth < 550;\n}\n\nfunction getFirstSubreddit(potentiallyMultiViewName) {\n  return potentiallyMultiViewName && potentiallyMultiViewName.split('+').map(x => x.trim())[0]\n}\n</script>\n\n<style lang='stylus'>\n@import './vars.styl';\n\n#app {\n  position: absolute;\n  top: 0;\n  background: background-color;\n}\n.no-webgl {\n  width: 100%;\n  color: hsla(215, 37%, 55%, 1);\n  flex-direction: column; text-align: center;\n  padding: 12px;\n}\n.no-webgl h4 {\n  margin: 7px 0;\n  font-size: 24px;\n}\n.subreddit .subreddit-action {\n  display: inline-block;\n  border: 1px solid;\n  color: primary-color;\n  border-radius: 3px;\n  padding: 0 8px;\n  margin: 8px;\n}\n\n.subreddit span.subreddit-action {\n  border-color: border-color;\n}\n\n.backdrop {\n  position fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.21);\n}\n\n.close-container {\n  position: fixed;\n  z-index: 2;\n  top: 0;\n  right: 0;\n  height: 40px;\n\n  a {\n    padding: 0 12px;\n    font-size: 12px;\n    color: #fff;\n    background-color: #333;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n  }\n}\n.support {\n  position: fixed;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0 8px;\n  font-size: 12px;\n  right: 8px;\n  top: 8px;\n  color: white;\n}\n.improve {\n  position: fixed;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0 8px;\n  font-size: 12px;\n  right: 8px;\n  bottom: 8px;\n}\n\n.fade-enter-active, .fade-leave-active {\n  transition: opacity .5s;\n}\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}\n\n.slide-bottom-enter-active, .slide-bottom-leave-active {\n  transition: transform .3s cubic-bezier(0,0,0.58,1);\n}\n.slide-bottom-enter, .slide-bottom-leave-to {\n  transform: translateY(84px);\n}\n\n.small-preview {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 84px;\n  background: rgba(5, 15, 43, 1); \n  box-shadow: 0 -4px 4px rgba(0,0,0,0.42);\n}\n\n.subreddit.preview {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: side-panel-width + 16px;\n  height: 100vh;\n  overflow: auto;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  align-items: baseline;\n}\n\n.row .label {\n  flex: 1;\n}\n\n.row .value {\n  flex: 1;\n}\n\n.row select {\n  width: 100%;\n}\n\n.btn-command {\n  display: block;\n  padding: 4px;\n  margin-top: 10px;\n  border: 1px solid;\n}\n\n.tooltip {\n  position: fixed;\n  background: post-background;\n  border: 1px solid border-hover;\n  color: primary-color;\n  padding: 8px;\n  pointer-events: none;\n  max-width: 400px;\n  transform: translateY(calc(-100% - 8px));\n  font-family: monospace;\n}\n\n.subreddit {\n  background: panel-background;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);\n  color: highlight-color;\n  .error {\n    color: white;\n    h3 {\n      color: error-color;\n    }\n  }\n  .background-area {\n    background: post-background;\n    border-bottom: 1px solid border-color;\n\n    .community-icon {\n      background: post-background;\n    }\n  }\n  h2, h3 {\n    color: primary-color;\n  }\n  .loading {\n    margin-top: 8px;\n  }\n  .age-warning  {\n    h2 {\n      text-align: center;\n      display: inline-block;\n    }\n  }\n  .error,\n  .age-warning {\n    margin-top: 62px;\n  }\n  a {\n    color: highlight-color;\n  }\n  .post {\n    background: post-background;\n    border: 1px solid border-color;\n    .url {\n      color: inherit;\n    }\n    .title, h1 {\n      color: primary-color;\n    }\n    a.comments-count {\n      &:hover {\n        background: hover-background;\n      }\n    }\n    .post-content, .byline {\n      a:hover {\n        background: hover-background;\n      }\n    }\n    .status-line {\n      background-color: #161617;\n      .vote-count {\n        color: primary-color;\n        background: initial;\n      }\n    }\n    .read-more {\n      background-image: linear-gradient(180deg,hsla(0,0%,100%,0), #171718);\n    }\n    &:hover {\n      border: 1px solid border-hover;\n    }\n  }\n}\n\na {\n  color: highlight-color;\n  text-decoration: none;\n}\n.search-box {\n  position: absolute;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02);\n  height: 48px;\n  font-size: 16px;\n  margin-top: 16px;\n  padding: 0;\n  cursor: text;\n  left: 8px;\n  width: side-panel-width;\n}\n\n.progress {\n  position: fixed;\n  top: 0px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: white;\n  padding: 8px;\n  background: rgba(5, 15, 43, 0.4);\n  box-shadow: 0 4px 4px rgba(0,0,0,0.2);\n  user-select: none;\n}\n\n.slide-left-enter-active, .slide-left-leave-active {\n  transition: transform 150ms cubic-bezier(0,0,0.58,1);\n}\n.slide-left-enter, .slide-left-leave-to {\n  transform: translateX(-100%);\n}\n\n.slide-top-enter-active, .slide-top-leave-active {\n  transition: opacity .3s cubic-bezier(0,0,0.58,1);\n}\n.slide-top-enter, .slide-top-leave-to {\n  opacity: 0;\n}\n.improve-window {\n  position: fixed;\n  transform: translate(-50%, -50%);\n  top: 0;\n  left: 50%;\n  top: 50%;\n  width: 400px;\n  background: white;\n  z-index: 2;\n  box-shadow: 0 -1px 24px rgb(0 0 0);\n  padding: 8px 16px;\n  overflow-y: auto;\n  max-height: 100%;\n  h3 {\n    margin: 0;\n  }\n  .close-btn {\n    position: absolute;\n    right: 8px;\n    top: 8px;\n  }\n}\na.accent {\n  color: highlight-link;\n}\n.sidebar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  width: side-panel-width - 10px;\n  background: white;\n  z-index: 2;\n  box-shadow: 0 -1px 24px rgb(0 0 0);\n  display: flex;\n  flex-direction: column;\n\n  h3 {\n    font-weight: normal;\n    margin: 8px 8px 0 8px;\n    font-size: 18px;\n    flex: 1;\n  }\n  .close-btn {\n    align-self: stretch;\n    align-items: center;\n    display: flex;\n    padding: 0 8px;\n  }\n\n  .container {\n    padding: 8px;\n    flex: 1;\n    overflow-y: auto;\n  }\n  h4 {\n    margin: 0;\n    font-weight: normal;\n    text-align: right;\n  }\n  .byline {\n    margin: 0 8px 8px;\n    font-size: 12px;\n  }\n}\n.progress.subgraph {\n  max-width: 400px;\n  text-align: center;\n}\n\n@media (max-width: 1200px) {\n  .progress {\n    top: 16px;\n    right: 8px;\n    left: inherit;\n    transform: inherit;\n  }\n  .support.subgraph {\n    top: 80px;\n  }\n}\n@media (max-width: 810px) {\n  .progress.subgraph {\n    top: 62px;\n    left: 8px;\n  }\n}\n\n@media (max-width: small-screen-width) {\n  #app {\n    width: 100%;\n    margin: 0;\n  }\n  .sidebar {\n    width: 100%;\n  }\n  .search-box {\n    left: 0;\n    margin-top: 0;\n    width: 100%;\n  }\n  .support {\n    bottom: 8px;\n    left: 8px;\n    right: unset;\n    top: unset;\n  }\n  .support.subgraph {\n    top: unset;\n  }\n\n  .improve-window {\n    width: 100%;\n    height: 100%;\n  }\n  .subreddit.preview {\n    width: 100%;\n  }\n  .progress, .progress.subgraph  {\n    top: 48px;\n    left: 0;\n    color: white;\n    text-align: center;\n    width: 100%;\n    position: absolute;\n    transform: initial;\n    box-shadow: initial;\n  }\n  .support.street {\n    display: none;\n  }\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=522a09c6\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=522a09c6&prod&lang=stylus\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n\ndocument.querySelector('.loading-script')?.remove();","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=style&index=0&id=7b1a6d47&prod&lang=stylus\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=style&index=0&id=6bfb7a94&prod&lang=stylus\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=522a09c6&prod&lang=stylus\""],"sourceRoot":""}